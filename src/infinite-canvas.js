var InfiniteCanvas=function(t){var n={};function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(i,o,function(n){return t[n]}.bind(null,o));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){var{InfiniteCanvas:i}=e(1);t.exports=i},function(t,n,e){"use strict";e.r(n);var i,o,r=function(){function t(t){this.viewBox=t}return t.prototype.restore=function(){this.viewBox.restoreState()},t.prototype.save=function(){this.viewBox.saveState()},t}(),s=function(){function t(t,n){this.x=t,this.y=n}return t.prototype.mod=function(){return Math.sqrt(this.modSq())},t.prototype.modSq=function(){return this.x*this.x+this.y*this.y},t.prototype.minus=function(n){return new t(this.x-n.x,this.y-n.y)},t.prototype.plus=function(n){return new t(this.x+n.x,this.y+n.y)},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},t.prototype.getPerpendicular=function(){return new t(-this.y,this.x)},t.prototype.scale=function(n){return new t(n*this.x,n*this.y)},t.prototype.projectOn=function(t){return t.scale(this.dot(t)/t.modSq())},t.prototype.matrix=function(n,e,i,o){return new t(n*this.x+e*this.y,i*this.x+o*this.y)},t.prototype.inSameDirectionAs=function(t){return 0===this.cross(t)&&this.dot(t)>=0},t.prototype.isInOppositeDirectionAs=function(t){return 0===this.cross(t)&&this.dot(t)<0},t.prototype.isOnSameSideOfOriginAs=function(t,n){return this.isInSmallerAngleBetweenPoints(t,n)||t.isInSmallerAngleBetweenPoints(this,n)||n.isInSmallerAngleBetweenPoints(this,t)},t.prototype.isInSmallerAngleBetweenPoints=function(t,n){var e=t.cross(n);return e>0?t.cross(this)>=0&&this.cross(n)>=0:e<0?t.cross(this)<=0&&this.cross(n)<=0:!(t.dot(n)>0)||0===this.cross(t)&&this.dot(t)>0},t.origin=new t(0,0),t}(),a=function(){function t(t,n,e,i,o,r){this.a=t,this.b=n,this.c=e,this.d=i,this.e=o,this.f=r,this.scale=Math.sqrt(t*i-n*e)}return t.prototype.getMaximumLineWidthScale=function(){var t=this.a+this.c,n=this.b+this.d,e=this.a-this.c,i=this.b-this.d;return Math.sqrt(Math.max(t*t+n*n,e*e+i*i))},t.prototype.getRotationAngle=function(){var t=this.a/this.scale,n=this.b/this.scale;if(0===t)return n>0?Math.PI/2:3*Math.PI/2;var e=Math.atan(n/t);return t>0?n>0?e:0===n?0:2*Math.PI+e:n>0?Math.PI+e:0===n?Math.PI:Math.PI+e},t.prototype.applyToPointAtInfinity=function(t){return{direction:this.untranslated().apply(t.direction)}},t.prototype.apply=function(t){return new s(this.a*t.x+this.c*t.y+this.e,this.b*t.x+this.d*t.y+this.f)},t.prototype.untranslated=function(){var n=this.apply(s.origin),e=n.x,i=n.y;return this.before(t.translation(-e,-i))},t.prototype.before=function(n){return new t(n.a*this.a+n.c*this.b,n.b*this.a+n.d*this.b,n.a*this.c+n.c*this.d,n.b*this.c+n.d*this.d,n.a*this.e+n.c*this.f+n.e,n.b*this.e+n.d*this.f+n.f)},t.prototype.equals=function(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f},t.prototype.inverse=function(){var n=this.a*this.d-this.b*this.c;if(0==n)throw"error calculating inverse: zero determinant";return new t(this.d/n,-this.b/n,-this.c/n,this.a/n,(this.c*this.f-this.d*this.e)/n,(this.b*this.e-this.a*this.f)/n)},t.translation=function(n,e){return new t(1,0,0,1,n,e)},t.scale=function(n){return new t(n,0,0,n,0,0)},t.zoom=function(n,e,i,o,r){var s=1-i;return void 0!==o?new t(i,0,0,i,n*s+o,e*s+r):new t(i,0,0,i,n*s,e*s)},t.translateZoom=function(n,e,i,o,r,s,a,c){var u=i-n,h=o-e,p=u*u+h*h;if(0===p)throw new Error("divide by 0");var f=a-r,l=c-s,d=f*f+l*l,y=Math.sqrt(d/p);return t.zoom(n,e,y,r-n,s-e)},t.rotation=function(n,e,i){var o=Math.cos(i),r=Math.sin(i),s=1-o;return new t(o,r,-r,o,n*s+e*r,-n*r+e*s)},t.translateRotateZoom=function(n,e,i,o,r,s,a,c){var u=i-n,h=o-e,p=u*u+h*h;if(0===p)throw new Error("divide by 0");var f=a-r,l=c-s,d=n*o-e*i,y=i*u+o*h,v=n*u+e*h,P=(u*f+h*l)/p,g=(u*l-h*f)/p;return new t(P,g,-g,P,(r*y-a*v-d*l)/p,(s*y-c*v+d*f)/p)},t.identity=new t(1,0,0,1,0,0),t}(),c=function(){function t(t){this.propertyName=t}return t.prototype.changeInstanceValue=function(t,n){return this.valuesAreEqual(t[this.propertyName],n)?t:t.changeProperty(this.propertyName,n)},t.prototype.isEqualForInstances=function(t,n){return this.valuesAreEqual(t[this.propertyName],n[this.propertyName])},t.prototype.getInstructionToChange=function(t,n){return this.valuesAreEqual(t[this.propertyName],n[this.propertyName])?function(){}:this.changeToNewValue(n[this.propertyName])},t.prototype.valueIsTransformableForInstance=function(t){return!0},t}(),u=(i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),h=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return u(n,t),n.prototype.valuesAreEqual=function(t,n){return t.equals(n)},n.prototype.changeToNewValue=function(t){return function(n,e){var i=e.inverse().before(t).before(e),o=i.a,r=i.b,s=i.c,a=i.d,c=i.e,u=i.f;n.setTransform(o,r,s,a,c,u)}},n}(c))("transformation"),p=function(){function t(t){this.viewBox=t}return t.prototype.getTransform=function(){if(DOMMatrix){var t=this.viewBox.state.current.transformation;return new DOMMatrix([t.a,t.b,t.c,t.d,t.e,t.f])}},t.prototype.resetTransform=function(){this.viewBox.changeState((function(t){return h.changeInstanceValue(t,a.identity)}))},t.prototype.rotate=function(t){this.addTransformation(a.rotation(0,0,t))},t.prototype.scale=function(t,n){this.addTransformation(new a(t,0,0,n,0,0))},t.prototype.setTransform=function(t,n,e,i,o,r){var s,c,u,p,f,l;"number"==typeof t?(s=t,c=n,u=e,p=i,f=o,l=r):void 0!==t.a?(s=t.a,c=t.b,u=t.c,p=t.d,f=t.e,l=t.f):(s=t.m11,c=t.m12,u=t.m21,p=t.m22,f=t.m41,l=t.m42),this.viewBox.changeState((function(t){return h.changeInstanceValue(t,new a(s,c,u,p,f,l))}))},t.prototype.transform=function(t,n,e,i,o,r){this.addTransformation(new a(t,n,e,i,o,r))},t.prototype.translate=function(t,n){this.addTransformation(a.translation(t,n))},t.prototype.addTransformation=function(t){var n=this.viewBox.state.current.transformation,e=t.before(n);this.viewBox.changeState((function(t){return h.changeInstanceValue(t,e)}))},t}(),f=function(){},l=function(){},d=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),y=function(t){function n(n){var e=t.call(this)||this;return e.fillStrokeStyle=n,e}return d(n,t),n.prototype.setTransform=function(t){this.fillStrokeStyle.setTransform(t)},n.prototype.getInstructionToSetUntransformed=function(t){var n=this;return function(e){e[t]=n.fillStrokeStyle}},n.prototype.getInstructionToSetTransformed=function(t){var n=this;return function(e){e[t]=n.fillStrokeStyle}},n}(l),v=function(){function t(t){this.propName=t}return t.prototype.changeInstanceValue=function(t,n){return t.changeProperty(this.propName,n)},t.prototype.isEqualForInstances=function(t,n){return t[this.propName]===n[this.propName]},t.prototype.getInstructionToChange=function(t,n){var e=this,i=n[this.propName];return this.isEqualForInstances(t,n)?i instanceof l&&t.fillAndStrokeStylesTransformed!==n.fillAndStrokeStylesTransformed?n.fillAndStrokeStylesTransformed?i.getInstructionToSetTransformed(this.propName):i.getInstructionToSetUntransformed(this.propName):function(){}:i instanceof l?n.fillAndStrokeStylesTransformed?i.getInstructionToSetTransformed(this.propName):i.getInstructionToSetUntransformed(this.propName):function(t){t[e.propName]=n[e.propName]}},t.prototype.valueIsTransformableForInstance=function(t){return!(t[this.propName]instanceof y)},t}(),P=new v("fillStyle"),g=new v("strokeStyle"),m=function(){function t(t){this.viewBox=t}return Object.defineProperty(t.prototype,"fillStyle",{set:function(t){this.viewBox.changeState((function(n){return P.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeStyle",{set:function(t){this.viewBox.changeState((function(n){return g.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),t.prototype.createLinearGradient=function(t,n,e,i){return this.viewBox.createLinearGradient(t,n,e,i)},t.prototype.createPattern=function(t,n){return this.viewBox.createPattern(t,n)},t.prototype.createRadialGradient=function(t,n,e,i,o,r){return this.viewBox.createRadialGradient(t,n,e,i,o,r)},t}(),w=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),I=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return w(n,t),n.prototype.valuesAreEqual=function(t,n){return t===n},n.prototype.changeToNewValue=function(t){return function(n){n.shadowColor=t}},n}(c))("shadowColor"),T=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),b=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return T(n,t),n.prototype.changeToNewValue=function(t){return function(n,e){var i=e.untranslated().apply(t),o=i.x,r=i.y;n.shadowOffsetX=o,n.shadowOffsetY=r}},n.prototype.valuesAreEqual=function(t,n){return t.x===n.x&&t.y==n.y},n.prototype.valuesAreEqualWhenTransformed=function(t,n){return 0===t.x&&0===t.y&&0===n.x&&0===n.y},n}(c))("shadowOffset"),x=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),S=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return x(n,t),n.prototype.valuesAreEqual=function(t,n){return t===n},n.prototype.changeToNewValue=function(t){return function(n,e){n.shadowBlur=t*e.scale}},n}(c))("shadowBlur"),C=function(){function t(t){this.viewBox=t}return Object.defineProperty(t.prototype,"shadowBlur",{get:function(){return this.viewBox.state.current.shadowBlur},set:function(t){this.viewBox.changeState((function(n){return S.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowOffsetX",{get:function(){return this.viewBox.state.current.shadowOffset.x},set:function(t){var n=new s(t,this.viewBox.state.current.shadowOffset.y);this.viewBox.changeState((function(t){return b.changeInstanceValue(t,n)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowOffsetY",{get:function(){return this.viewBox.state.current.shadowOffset.y},set:function(t){var n=new s(this.viewBox.state.current.shadowOffset.x,t);this.viewBox.changeState((function(t){return b.changeInstanceValue(t,n)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowColor",{get:function(){return this.viewBox.state.current.shadowColor},set:function(t){this.viewBox.changeState((function(n){return I.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),t}(),B=function(){},O=function(){function t(t){this.viewBox=t}return t.prototype.clearRect=function(t,n,e,i){this.viewBox.clearArea(t,n,e,i)},t.prototype.fillRect=function(t,n,e,i){this.viewBox.fillRect(t,n,e,i,(function(t){return t.fill()}))},t.prototype.strokeRect=function(t,n,e,i){this.viewBox.strokeRect(t,n,e,i)},t}(),_=function(){function t(t){this.viewBox=t}return t.prototype.isFillRule=function(t){return"evenodd"===t||"nonzero"===t},t.prototype.beginPath=function(){this.viewBox.beginPath()},t.prototype.clip=function(t,n){var e=this.isFillRule(t)?function(n){n.clip(t)}:function(t){t.clip()};this.viewBox.clipPath(e)},t.prototype.fill=function(t,n){if(t&&!this.isFillRule(t)||this.viewBox.currentPathCanBeFilled()){var e=this.isFillRule(t)?function(n){n.fill(t)}:function(t){t.fill()};this.viewBox.fillPath(e)}},t.prototype.isPointInPath=function(t,n,e,i){return!0},t.prototype.isPointInStroke=function(t,n,e){return!0},t.prototype.stroke=function(t){this.viewBox.strokePath()},t}(),A=function(){function t(){}return t.prototype.drawFocusIfNeeded=function(t,n){},t.prototype.scrollPathIntoView=function(t){},t}();!function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(o||(o={}));var D=function(){function t(t,n,e){this.point=t,this.halfPlane1=n,this.halfPlane2=e,this.normal1=n.normalTowardInterior,this.normal2=e.normalTowardInterior}return t.prototype.isExpandableToContainPoint=function(t){return this.halfPlane1.interiorContainsPoint(t)||this.halfPlane2.interiorContainsPoint(t)},t.prototype.isInSameHalfPlaneAs=function(t){return this.halfPlane1.containsPoint(t)||this.halfPlane2.containsPoint(t)},t.prototype.getHalfPlaneContaining=function(t){return this.halfPlane1.containsPoint(t)?this.halfPlane1:this.halfPlane2},t.prototype.expandToContainPoint=function(n){var e=this.halfPlane1.interiorContainsPoint(n)?this.halfPlane1:this.halfPlane2,i=n.minus(this.point).getPerpendicular();this.isContainedByHalfPlaneWithNormal(i)||(i=i.scale(-1));var o=new L(this.point,i);return{newHalfPlane:o,newVertex:new t(this.point,e,o)}},t.prototype.isContainedByHalfPlaneWithNormal=function(t){return t.isInSmallerAngleBetweenPoints(this.normal1,this.normal2)},t.prototype.containsPoint=function(t){return this.halfPlane1.containsPoint(t)&&this.halfPlane2.containsPoint(t)},t.prototype.containsLineSegmentWithDirection=function(t){return this.containsPoint(this.point.plus(t))||this.containsPoint(this.point.minus(t))},t.prototype.isContainedByVertex=function(t){return this.isContainedByHalfPlaneWithNormal(t.normal1)&&this.isContainedByHalfPlaneWithNormal(t.normal2)},t}(),L=function(){function t(t,n){this.base=t,this.normalTowardInterior=n,this.lengthOfNormal=n.mod()}return t.prototype.getDistanceFromEdge=function(t){return t.minus(this.base).dot(this.normalTowardInterior)/this.lengthOfNormal},t.prototype.transform=function(n){var e=n.apply(this.base),i=n.apply(this.base.plus(this.normalTowardInterior.getPerpendicular())),o=n.apply(this.base.plus(this.normalTowardInterior));return t.throughPointsAndContainingPoint(e,i,o)},t.prototype.complement=function(){return new t(this.base,this.normalTowardInterior.scale(-1))},t.prototype.expandByDistance=function(n){return new t(this.base.plus(this.normalTowardInterior.scale(-n/this.normalTowardInterior.mod())),this.normalTowardInterior)},t.prototype.expandToIncludePoint=function(n){return this.containsPoint(n)?this:new t(n,this.normalTowardInterior)},t.prototype.containsPoint=function(t){return this.getDistanceFromEdge(t)>=0},t.prototype.interiorContainsPoint=function(t){return this.getDistanceFromEdge(t)>0},t.prototype.containsInfinityInDirection=function(t){return t.dot(this.normalTowardInterior)>=0},t.prototype.isContainedByHalfPlane=function(t){return this.normalTowardInterior.inSameDirectionAs(t.normalTowardInterior)&&t.getDistanceFromEdge(this.base)>=0},t.prototype.intersectWithLine=function(t,n){return{point:(e=this.base,i=this.normalTowardInterior.getPerpendicular(),o=t,r=n,s=o.minus(e),a=r.cross(i),c=r.getPerpendicular().dot(s)/a,e.plus(i.scale(c))),halfPlane:this};var e,i,o,r,s,a,c},t.prototype.isParallelToLine=function(t,n){return 0===this.normalTowardInterior.getPerpendicular().cross(n)},t.prototype.getIntersectionWith=function(t){var n=this.intersectWithLine(t.base,t.normalTowardInterior.getPerpendicular());return new D(n.point,this,t)},t.throughPointsAndContainingPoint=function(n,e,i){for(var o=0,r=t.withBorderPoints(n,e);o<r.length;o++){var s=r[o];if(s.containsPoint(i))return s}},t.withBorderPointAndInfinityInDirection=function(n,e){return t.withBorderPoints(n,n.plus(e))},t.withBorderPoints=function(n,e){var i=e.minus(n).getPerpendicular();return[new t(n,i),new t(n,i.scale(-1))]},t}(),F=new(function(){function t(){}return t.prototype.expandToIncludePoint=function(t){return this},t.prototype.expandToIncludePolygon=function(t){return this},t.prototype.expandToIncludeInfinityInDirection=function(t){return this},t.prototype.intersects=function(t){return!0},t.prototype.expandToInclude=function(t){return this},t.prototype.transform=function(t){return this},t.prototype.intersectWithLineSegment=function(t){return t},t.prototype.contains=function(t){return!0},t.prototype.intersectWith=function(t){return t},t.prototype.intersectWithRay=function(t){return t},t.prototype.intersectWithLine=function(t){return t},t.prototype.intersectWithConvexPolygon=function(t){return t},t.prototype.isContainedByRay=function(t){return!1},t.prototype.isContainedByLineSegment=function(t){return!1},t.prototype.isContainedByLine=function(t){return!1},t.prototype.isContainedByConvexPolygon=function(t){return!1},t.prototype.intersectsRay=function(t){return!0},t.prototype.intersectsLineSegment=function(t){return!0},t.prototype.intersectsLine=function(t){return!0},t.prototype.intersectsConvexPolygon=function(t){return!0},t}()),W=function(){function t(n,e){this.vertices=e,this.halfPlanes=n,this.vertices=this.vertices||t.getVertices(this.halfPlanes)}return t.prototype.findVertex=function(t){for(var n=0,e=this.vertices;n<e.length;n++){var i=e[n];if(i.point.equals(t))return i}},t.prototype.intersects=function(t){return t.intersectsConvexPolygon(this)},t.prototype.intersectWith=function(t){return t.intersectWithConvexPolygon(this)},t.prototype.intersectWithRay=function(t){return t.intersectWithConvexPolygon(this)},t.prototype.intersectWithLine=function(t){return t.intersectWithConvexPolygon(this)},t.prototype.intersectWithLineSegment=function(t){return t.intersectWithConvexPolygon(this)},t.prototype.contains=function(t){return t.isContainedByConvexPolygon(this)},t.prototype.containsHalfPlane=function(t){for(var n=0,e=this.halfPlanes;n<e.length;n++){var i=e[n];if(!t.isContainedByHalfPlane(i))return!1}return!0},t.prototype.isContainedByHalfPlane=function(t){for(var n=0,e=this.vertices;n<e.length;n++){var i=e[n];if(!t.containsPoint(i.point))return!1}for(var o=t.complement(),r=0,s=this.halfPlanes;r<s.length;r++){if((u=s[r]).isContainedByHalfPlane(t))return!0}for(var a=0,c=this.halfPlanes;a<c.length;a++){var u=c[a];if(this.hasAtMostOneVertex(u)&&(u.isContainedByHalfPlane(o)||o.isContainedByHalfPlane(u)))return!1;var h=u.getIntersectionWith(t),p=this.findVertex(h.point);if(p){if(!p.isContainedByHalfPlaneWithNormal(t.normalTowardInterior))return!1}else if(this.containsPoint(h.point))return!1}return!this.containsHalfPlane(t)},t.prototype.getPointInFrontInDirection=function(t,n){for(var e,i=0,o=0,r=this.vertices;o<r.length;o++){var s=r[o],a=s.point.minus(t).dot(n);a>i&&(e=s.point,i=a)}return e?t.plus(e.minus(t).projectOn(n)):t},t.prototype.expandToIncludePoint=function(n){if(this.containsPoint(n))return this;for(var e=[],i=[],o=0,r=this.halfPlanes;o<r.length;o++){var s=r[o];this.hasAtMostOneVertex(s)&&!s.containsPoint(n)&&e.push(s.expandToIncludePoint(n))}if(0===this.vertices.length)return new t(e.concat(this.halfPlanes.filter((function(t){return t.containsPoint(n)}))));for(var a=0,c=this.vertices;a<c.length;a++){var u=c[a];if(u.containsPoint(n))i.push(u);else if(u.isExpandableToContainPoint(n)){var h=u.expandToContainPoint(n);e.push(h.newHalfPlane),i.push(h.newVertex)}else u.isInSameHalfPlaneAs(n)&&e.push(u.getHalfPlaneContaining(n))}if(2!==e.length)throw new Error("expected two new half planes");return i.push(new D(n,e[0],e[1])),e=t.getHalfPlanes(i),new t(e,i)},t.prototype.expandToIncludeInfinityInDirection=function(n){if(this.containsInfinityInDirection(n))return this;var e=this.halfPlanes.filter((function(t){return t.containsInfinityInDirection(n)})).concat(this.getTangentPlanesThroughInfinityInDirection(n));return 0===(e=t.getHalfPlanesNotContainingAnyOther(e)).length?F:new t(e)},t.prototype.getIntersectionsWithLine=function(t,n){for(var e=[],i=0,o=this.halfPlanes;i<o.length;i++){var r=o[i];if(!r.isParallelToLine(t,n)){var s=r.intersectWithLine(t,n),a=this.findVertex(s.point);a&&!a.containsLineSegmentWithDirection(n)||this.containsPoint(s.point)&&e.push(s)}}return e},t.prototype.expandByDistance=function(n){return new t(this.halfPlanes.map((function(t){return t.expandByDistance(n)})))},t.prototype.transform=function(n){return new t(this.halfPlanes.map((function(t){return t.transform(n)})))},t.prototype.intersectWithConvexPolygon=function(n){if(n.isContainedByConvexPolygon(this))return n;if(this.isContainedByConvexPolygon(n))return this;if(!this.isOutsideConvexPolygon(n)){var e=t.getHalfPlanesNotContainingAnyOther(this.halfPlanes.concat(n.halfPlanes)),i=t.groupVerticesByPoint(t.getVertices(e)).map((function(n){return t.getVerticesNotContainingAnyOther(n)})).reduce((function(t,n){return t.concat(n)}),[]);if(0===i.length)return new t(e);var o=t.getHalfPlanes(i);return new t(o)}},t.prototype.containsInfinityInDirection=function(t){for(var n=0,e=this.halfPlanes;n<e.length;n++){if(!e[n].containsInfinityInDirection(t))return!1}return!0},t.prototype.containsPoint=function(t){for(var n=0,e=this.halfPlanes;n<e.length;n++){if(!e[n].containsPoint(t))return!1}return!0},t.prototype.intersectsRay=function(t){return t.intersectsConvexPolygon(this)},t.prototype.intersectsLineSegment=function(t){return t.intersectsConvexPolygon(this)},t.prototype.intersectsLine=function(t){return t.intersectsConvexPolygon(this)},t.prototype.intersectsConvexPolygon=function(t){return!(!this.isContainedByConvexPolygon(t)&&!t.isContainedByConvexPolygon(this))||!this.isOutsideConvexPolygon(t)},t.prototype.isOutsideConvexPolygon=function(t){for(var n=0,e=t.halfPlanes;n<e.length;n++){var i=e[n];if(this.isContainedByHalfPlane(i.complement()))return!0}for(var o=0,r=this.halfPlanes;o<r.length;o++){var s=r[o];if(t.isContainedByHalfPlane(s.complement()))return!0}return!1},t.prototype.hasAtMostOneVertex=function(t){for(var n=0,e=0,i=this.vertices;e<i.length;e++){var o=i[e];if((o.halfPlane1===t||o.halfPlane2===t)&&++n>1)return!1}return!0},t.prototype.getTangentPlanesThroughInfinityInDirection=function(t){for(var n=[],e=0,i=this.vertices;e<i.length;e++)for(var o=i[e],r=0,s=L.withBorderPointAndInfinityInDirection(o.point,t);r<s.length;r++){var a=s[r];this.isContainedByHalfPlane(a)&&n.push(a)}return n},t.prototype.isContainedByRay=function(t){return!1},t.prototype.isContainedByLineSegment=function(t){return!1},t.prototype.isContainedByLine=function(t){return!1},t.prototype.isContainedByConvexPolygon=function(t){for(var n=0,e=t.halfPlanes;n<e.length;n++){var i=e[n];if(!this.isContainedByHalfPlane(i))return!1}return!0},t.getHalfPlanes=function(t){for(var n=[],e=0,i=t;e<i.length;e++){var o=i[e];-1===n.indexOf(o.halfPlane1)&&n.push(o.halfPlane1),-1===n.indexOf(o.halfPlane2)&&n.push(o.halfPlane2)}return n},t.getVerticesNotContainingAnyOther=function(t){for(var n=[],e=0;e<t.length;e++){for(var i=!0,o=0;o<t.length;o++)if(e!==o&&t[o].isContainedByVertex(t[e])){i=!1;break}i&&n.push(t[e])}return n},t.getHalfPlanesNotContainingAnyOther=function(t){for(var n=[],e=0,i=t;e<i.length;e++){for(var o=i[e],r=!0,s=0,a=n;s<a.length;s++){if(a[s].isContainedByHalfPlane(o)){r=!1;break}}r&&n.push(o)}return n},t.groupVerticesByPoint=function(t){for(var n=[],e=0,i=t;e<i.length;e++){for(var o=i[e],r=void 0,s=0,a=n;s<a.length;s++){var c=a[s];if(c[0].point.equals(o.point)){r=c;break}}r?r.push(o):n.push([o])}return n},t.getVertices=function(t){for(var n=[],e=0;e<t.length;e++)for(var i=e+1;i<t.length;i++)if(!t[e].complement().isContainedByHalfPlane(t[i])){for(var o=t[e].getIntersectionWith(t[i]),r=!0,s=0;s<t.length;s++)if(s!==e&&s!==i&&!t[s].containsPoint(o.point)){r=!1;break}r&&n.push(o)}return n},t.createTriangleWithInfinityInTwoDirections=function(n,e,i){var o=e.getPerpendicular(),r=i.getPerpendicular();return e.cross(i)<0?new t([new L(n,o.scale(-1)),new L(n,r)]):new t([new L(n,o),new L(n,r.scale(-1))])},t.createFromHalfPlane=function(n){return new t([n])},t.createTriangleWithInfinityInDirection=function(n,e,i){var o=e.minus(n).projectOn(i.getPerpendicular());return new t([new L(n,o),new L(e,o.scale(-1)),L.throughPointsAndContainingPoint(n,e,n.plus(i))])},t.createTriangle=function(n,e,i){return new t([L.throughPointsAndContainingPoint(n,e,i),L.throughPointsAndContainingPoint(n,i,e),L.throughPointsAndContainingPoint(e,i,n)])},t.createRectangle=function(n,e,i,o){var r=[];return Number.isFinite(n)&&(r.push(new L(new s(n,0),new s(i>0?1:-1,0))),Number.isFinite(i)&&r.push(new L(new s(n+i,0),new s(i>0?-1:1,0)))),Number.isFinite(e)&&(r.push(new L(new s(0,e),new s(0,o>0?1:-1))),Number.isFinite(o)&&r.push(new L(new s(0,e+o),new s(0,o>0?-1:1)))),new t(r)},t}(),j=function(){function t(t){this.viewBox=t}return t.prototype.fillText=function(t,n,e,i){var r=void 0===i?function(i){i.fillText(t,n,e)}:function(o){o.fillText(t,n,e,i)};this.viewBox.addDrawing(r,this.getDrawnRectangle(n,e,t),o.Relative,!0)},t.prototype.measureText=function(t){return this.viewBox.measureText(t)},t.prototype.strokeText=function(t,n,e,i){var r=void 0===i?function(i){i.strokeText(t,n,e)}:function(o){o.strokeText(t,n,e,i)};this.viewBox.addDrawing(r,this.getDrawnRectangle(n,e,t),o.Relative,!0)},t.prototype.getDrawnRectangle=function(t,n,e){var i,o=this.viewBox.measureText(e);i=void 0!==o.actualBoundingBoxRight?Math.abs(o.actualBoundingBoxRight-o.actualBoundingBoxLeft):o.width;var r=void 0!==o.actualBoundingBoxAscent?o.actualBoundingBoxAscent+o.actualBoundingBoxDescent:1,s=void 0!==o.actualBoundingBoxAscent?o.actualBoundingBoxAscent:0;return W.createRectangle(t,n-s,i,r)},t}(),R=function(){function t(t){this.viewBox=t}return t.prototype.drawImage=function(){var t,n,e,i,r,s,a,c,u,h=Array.prototype.slice.apply(arguments);arguments.length<=5?(t=h[0],s=h[1],a=h[2],c=h[3],u=h[4]):(t=h[0],n=h[1],e=h[2],i=h[3],r=h[4],s=h[5],a=h[6],c=h[7],u=h[8]);var p=this.getDrawnLength(t.width,n,i,c),f=this.getDrawnLength(t.height,e,r,u),l=W.createRectangle(s,a,p,f),d=this.getDrawImageInstruction(arguments.length,t,n,e,i,r,s,a,c,u);this.viewBox.addDrawing(d,l,o.Relative,!0)},t.prototype.getDrawImageInstruction=function(t,n,e,i,o,r,s,a,c,u){switch(t){case 3:return function(t){t.drawImage(n,s,a)};case 5:return function(t){t.drawImage(n,s,a,c,u)};case 9:return function(t){t.drawImage(n,e,i,o,r,s,a,c,u)};default:throw new TypeError("Failed to execute 'drawImage' on 'CanvasRenderingContext2D': Valid arities are: [3, 5, 9], but "+t+" arguments provided.")}},t.prototype.getDrawnLength=function(t,n,e,i){var o=this.getLength(t);return void 0!==i?i:void 0!==n?void 0!==e?e:o-n:o},t.prototype.getLength=function(t){return"number"==typeof t?t:t.baseVal.value},t}();var k=function(){function t(t){this.viewBox=t}return t.prototype.createImageData=function(t,n){},t.prototype.getImageData=function(t,n,e,i){},t.prototype.putImageData=function(t,n,e,i,r,s,a){var c;t=function(t,n,e,i,o){n=void 0===n?0:n,e=void 0===e?0:e,i=void 0===i?t.width:i,o=void 0===o?t.height:o;for(var r=t.data,s=new Uint8ClampedArray(4*i*o),a=0;a<o;a++)for(var c=0;c<i;c++){var u=4*((e+a)*t.width+n+c),h=4*(a*i+c);s[h]=r[u],s[h+1]=r[u+1],s[h+2]=r[u+2],s[h+3]=r[u+3]}return new ImageData(s,i,o)}(t,i,r,s,a);var u=this.viewBox.getDrawingLock();this.viewBox.createPatternFromImageData(t).then((function(t){c=t,u.release()})),this.viewBox.addDrawing((function(i){i.translate(n,e),i.fillStyle=c,i.imageSmoothingEnabled=!1,i.fillRect(0,0,t.width,t.height)}),W.createRectangle(n,e,t.width,t.height),o.Absolute,!1)},t}(),N=function(){function t(t){this.propertyName=t}return t.prototype.changeInstanceValue=function(t,n){return this.valuesAreEqual(t[this.propertyName],n)?t:t.changeProperty(this.propertyName,n)},t.prototype.isEqualForInstances=function(t,n){return this.valuesAreEqual(t[this.propertyName],n[this.propertyName])},t.prototype.valueIsTransformableForInstance=function(t){return!0},t.prototype.changeToNewValue=function(t,n){return n?this.changeToNewValueTransformed(t):this.changeToNewValueUntransformed(t)},t.prototype.getInstructionToChange=function(t,n){var e=t[this.propertyName],i=n[this.propertyName];return this.valuesAreEqual(e,i)&&(t.fillAndStrokeStylesTransformed===n.fillAndStrokeStylesTransformed||this.valuesAreEqualWhenTransformed(e,i))?function(){}:this.changeToNewValue(i,n.fillAndStrokeStylesTransformed)},t}(),V=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),M=function(t){function n(n){return t.call(this,n)||this}return V(n,t),n.prototype.valuesAreEqual=function(t,n){return t===n},n.prototype.changeToNewValueTransformed=function(t){var n=this;return function(e,i){e[n.propertyName]=t*i.scale}},n.prototype.changeToNewValueUntransformed=function(t){var n=this;return function(e){e[n.propertyName]=t}},n.prototype.valuesAreEqualWhenTransformed=function(t,n){return 0===t&&0===n},n}(N),E=new M("lineWidth"),q=new M("lineDashOffset"),H=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),G=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return H(n,t),n.prototype.valuesAreEqual=function(t,n){if(t.length!==n.length)return!1;for(var e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0},n.prototype.changeToNewValueTransformed=function(t){return function(n,e){n.setLineDash(t.map((function(t){return t*e.scale})))}},n.prototype.changeToNewValueUntransformed=function(t){return function(n){n.setLineDash(t)}},n.prototype.valuesAreEqualWhenTransformed=function(t,n){return 0===t.length&&0===n.length},n}(N))("lineDash"),z=function(){function t(t){this.viewBox=t}return Object.defineProperty(t.prototype,"lineDashOffset",{get:function(){return this.viewBox.state.current.lineDashOffset},set:function(t){this.viewBox.changeState((function(n){return q.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this.viewBox.state.current.lineWidth},set:function(t){this.viewBox.changeState((function(n){return E.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),t.prototype.getLineDash=function(){return this.viewBox.state.current.lineDash},t.prototype.setLineDash=function(t){t.length%2==1&&(t=t.concat(t)),this.viewBox.changeState((function(n){return G.changeInstanceValue(n,t)}))},t}(),U=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Y=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return U(n,t),n.prototype.valuesAreEqual=function(t,n){return t===n},n.prototype.changeToNewValue=function(t){return function(n){n.direction=t}},n}(c))("direction"),X=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Z=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return X(n,t),n.prototype.valuesAreEqual=function(t,n){return t===n},n.prototype.changeToNewValue=function(t){return function(n){n.font=t}},n}(c))("font"),J=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Q=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return J(n,t),n.prototype.valuesAreEqual=function(t,n){return t===n},n.prototype.changeToNewValue=function(t){return function(n){n.textAlign=t}},n}(c))("textAlign"),K=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),$=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return K(n,t),n.prototype.valuesAreEqual=function(t,n){return t===n},n.prototype.changeToNewValue=function(t){return function(n){n.textBaseline=t}},n}(c))("textBaseline"),tt=function(){function t(t){this.viewBox=t}return Object.defineProperty(t.prototype,"direction",{set:function(t){this.viewBox.changeState((function(n){return Y.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{set:function(t){this.viewBox.changeState((function(n){return Z.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textAlign",{set:function(t){this.viewBox.changeState((function(n){return Q.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{set:function(t){this.viewBox.changeState((function(n){return $.changeInstanceValue(n,t)}))},enumerable:!0,configurable:!0}),t}(),nt=function(){function t(){}return t.arc=function(t,n,e,i,o,r){return{instruction:function(a,c){var u=c.getRotationAngle(),h=c.apply(new s(t,n)),p=h.x,f=h.y;a.arc(p,f,e*c.scale,i+u,o+u,r)},changeArea:function(i){i.addPosition(new s(t-e,n-e)),i.addPosition(new s(t-e,n+e)),i.addPosition(new s(t+e,n-e)),i.addPosition(new s(t+e,n+e))},positionChange:new s(t,n).plus(a.rotation(0,0,o).apply(new s(e,0))),initialPoint:new s(t,n).plus(a.rotation(0,0,i).apply(new s(e,0)))}},t.arcTo=function(t,n,e,i,o){var r=new s(t,n),a=new s(e,i);return{instruction:function(t,n){var e=n.apply(r),i=n.apply(a);t.arcTo(e.x,e.y,i.x,i.y,o*n.scale)},changeArea:function(t){t.addPosition(r),t.addPosition(a)},positionChange:new s(e,i)}},t.bezierCurveTo=function(t,n,e,i,o,r){},t.ellipse=function(t,n,e,i,o,r,c,u){return{instruction:function(a,h){var p=h.apply(new s(t,n)),f=h.getRotationAngle();a.ellipse(p.x,p.y,e*h.scale,i*h.scale,o+f,r,c,u)},changeArea:function(o){o.addPosition(new s(t-e,n-i)),o.addPosition(new s(t-e,n+i)),o.addPosition(new s(t+e,n-i)),o.addPosition(new s(t+e,n+i))},positionChange:new s(t,n).plus(a.rotation(0,0,c).before(new a(e,0,0,i,0,0)).before(a.rotation(0,0,o)).apply(new s(1,0))),initialPoint:new s(t,n).plus(a.rotation(0,0,r).before(new a(e,0,0,i,0,0)).before(a.rotation(0,0,o)).apply(new s(1,0)))}},t.quadraticCurveTo=function(t,n,e,i){},t}(),et=function(){function t(t){this.viewBox=t}return t.prototype.arc=function(t,n,e,i,o,r){this.viewBox.addPathInstruction(nt.arc(t,n,e,i,o,r))},t.prototype.arcTo=function(t,n,e,i,o){this.viewBox.addPathInstruction(nt.arcTo(t,n,e,i,o))},t.prototype.bezierCurveTo=function(t,n,e,i,o,r){},t.prototype.closePath=function(){this.viewBox.closePath()},t.prototype.ellipse=function(t,n,e,i,o,r,s,a){this.viewBox.addPathInstruction(nt.ellipse(t,n,e,i,o,r,s,a))},t.prototype.lineTo=function(t,n){this.viewBox.lineTo(new s(t,n))},t.prototype.lineToInfinityInDirection=function(t,n){this.viewBox.lineTo({direction:new s(t,n)})},t.prototype.moveTo=function(t,n){this.viewBox.moveTo(new s(t,n))},t.prototype.moveToInfinityInDirection=function(t,n){this.viewBox.moveTo({direction:new s(t,n)})},t.prototype.quadraticCurveTo=function(t,n,e,i){},t.prototype.rect=function(t,n,e,i){this.viewBox.rect(t,n,e,i)},t}(),it=function(){function t(t,n){this.canvas=t,this.canvasState=new r(n),this.canvasTransform=new p(n),this.canvasCompositing=new f,this.canvasStrokeStyles=new m(n),this.canvasShadowStyles=new C(n),this.canvasFilters=new B,this.canvasRect=new O(n),this.canvasDrawPath=new _(n),this.canvasUserInterface=new A,this.canvasText=new j(n),this.canvasDrawImage=new R(n),this.canvasImageData=new k(n),this.canvasPathDrawingStyles=new z(n),this.canvasTextDrawingStyles=new tt(n),this.canvasPath=new et(n)}return t.prototype.save=function(){this.canvasState.save()},t.prototype.restore=function(){this.canvasState.restore()},t.prototype.getTransform=function(){return this.canvasTransform.getTransform()},t.prototype.resetTransform=function(){this.canvasTransform.resetTransform()},t.prototype.rotate=function(t){this.canvasTransform.rotate(t)},t.prototype.scale=function(t,n){this.canvasTransform.scale(t,n)},t.prototype.setTransform=function(t,n,e,i,o,r){this.canvasTransform.setTransform(t,n,e,i,o,r)},t.prototype.transform=function(t,n,e,i,o,r){this.canvasTransform.transform(t,n,e,i,o,r)},t.prototype.translate=function(t,n){this.canvasTransform.translate(t,n)},Object.defineProperty(t.prototype,"globalAlpha",{set:function(t){this.canvasCompositing.globalAlpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalCompositeOperation",{set:function(t){this.canvasCompositing.globalCompositeOperation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageSmoothingEnabled",{set:function(t){this.canvasImageSmoothing.imageSmoothingEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageSmoothingQuality",{set:function(t){this.canvasImageSmoothing.imageSmoothingQuality=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillStyle",{set:function(t){this.canvasStrokeStyles.fillStyle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeStyle",{set:function(t){this.canvasStrokeStyles.strokeStyle=t},enumerable:!0,configurable:!0}),t.prototype.createLinearGradient=function(t,n,e,i){return this.canvasStrokeStyles.createLinearGradient(t,n,e,i)},t.prototype.createPattern=function(t,n){return this.canvasStrokeStyles.createPattern(t,n)},t.prototype.createRadialGradient=function(t,n,e,i,o,r){return this.canvasStrokeStyles.createRadialGradient(t,n,e,i,o,r)},Object.defineProperty(t.prototype,"shadowBlur",{set:function(t){this.canvasShadowStyles.shadowBlur=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowColor",{set:function(t){this.canvasShadowStyles.shadowColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowOffsetX",{set:function(t){this.canvasShadowStyles.shadowOffsetX=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowOffsetY",{set:function(t){this.canvasShadowStyles.shadowOffsetY=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filter",{set:function(t){this.canvasFilters.filter=t},enumerable:!0,configurable:!0}),t.prototype.clearRect=function(t,n,e,i){this.canvasRect.clearRect(t,n,e,i)},t.prototype.fillRect=function(t,n,e,i){this.canvasRect.fillRect(t,n,e,i)},t.prototype.strokeRect=function(t,n,e,i){this.canvasRect.strokeRect(t,n,e,i)},t.prototype.beginPath=function(){this.canvasDrawPath.beginPath()},t.prototype.clip=function(t,n){this.canvasDrawPath.clip(t,n)},t.prototype.fill=function(t,n){this.canvasDrawPath.fill(t,n)},t.prototype.isPointInPath=function(t,n,e,i){return this.canvasDrawPath.isPointInPath(t,n,e,i)},t.prototype.isPointInStroke=function(t,n,e){return this.canvasDrawPath.isPointInStroke(t,n,e)},t.prototype.stroke=function(t){this.canvasDrawPath.stroke(t)},t.prototype.drawFocusIfNeeded=function(t,n){this.canvasUserInterface.drawFocusIfNeeded(t,n)},t.prototype.scrollPathIntoView=function(t){this.canvasUserInterface.scrollPathIntoView(t)},t.prototype.fillText=function(t,n,e,i){this.canvasText.fillText(t,n,e,i)},t.prototype.measureText=function(t){return this.canvasText.measureText(t)},t.prototype.strokeText=function(t,n,e,i){this.canvasText.strokeText(t,n,e,i)},t.prototype.drawImage=function(){this.canvasDrawImage.drawImage.apply(this.canvasDrawImage,arguments)},t.prototype.createImageData=function(t,n){return this.canvasImageData.createImageData(t,n)},t.prototype.getImageData=function(t,n,e,i){return this.canvasImageData.getImageData(t,n,e,i)},t.prototype.putImageData=function(t,n,e,i,o,r,s){this.canvasImageData.putImageData(t,n,e,i,o,r,s)},Object.defineProperty(t.prototype,"lineCap",{set:function(t){this.canvasPathDrawingStyles.lineCap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineDashOffset",{set:function(t){this.canvasPathDrawingStyles.lineDashOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{set:function(t){this.canvasPathDrawingStyles.lineJoin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{set:function(t){this.canvasPathDrawingStyles.lineWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{set:function(t){this.canvasPathDrawingStyles.miterLimit=t},enumerable:!0,configurable:!0}),t.prototype.getLineDash=function(){return this.canvasPathDrawingStyles.getLineDash()},t.prototype.setLineDash=function(t){this.canvasPathDrawingStyles.setLineDash(t)},Object.defineProperty(t.prototype,"direction",{set:function(t){this.canvasTextDrawingStyles.direction=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{set:function(t){this.canvasTextDrawingStyles.font=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textAlign",{set:function(t){this.canvasTextDrawingStyles.textAlign=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{set:function(t){this.canvasTextDrawingStyles.textBaseline=t},enumerable:!0,configurable:!0}),t.prototype.arc=function(t,n,e,i,o,r){this.canvasPath.arc(t,n,e,i,o,r)},t.prototype.arcTo=function(t,n,e,i,o){this.canvasPath.arcTo(t,n,e,i,o)},t.prototype.bezierCurveTo=function(t,n,e,i,o,r){this.canvasPath.bezierCurveTo(t,n,e,i,o,r)},t.prototype.closePath=function(){this.canvasPath.closePath()},t.prototype.ellipse=function(t,n,e,i,o,r,s,a){this.canvasPath.ellipse(t,n,e,i,o,r,s)},t.prototype.lineTo=function(t,n){this.canvasPath.lineTo(t,n)},t.prototype.lineToInfinityInDirection=function(t,n){this.canvasPath.lineToInfinityInDirection(t,n)},t.prototype.moveTo=function(t,n){this.canvasPath.moveTo(t,n)},t.prototype.moveToInfinityInDirection=function(t,n){this.canvasPath.moveToInfinityInDirection(t,n)},t.prototype.quadraticCurveTo=function(t,n,e,i){this.canvasPath.quadraticCurveTo(t,n,e,i)},t.prototype.rect=function(t,n,e,i){if(!Number.isFinite(t)&&!Number.isFinite(n))throw new Error("The starting coordinates provided ("+t+" and "+n+") do not determine a direction.");this.canvasPath.rect(t,n,e,i)},t}(),ot=function(){function t(t,n,e){this.area=t,this.latestClippedPath=n,this.previouslyClippedPaths=e}return t.prototype.withClippedPath=function(n){return new t(n.getClippedArea(this.area),n,this)},Object.defineProperty(t.prototype,"initialState",{get:function(){return this.previouslyClippedPaths?this.previouslyClippedPaths.initialState:this.latestClippedPath.initialState},enumerable:!0,configurable:!0}),t.prototype.except=function(n){if(n!==this)return this.previouslyClippedPaths?new t(this.area,this.latestClippedPath,this.previouslyClippedPaths.except(n)):this},t.prototype.contains=function(t){return!!t&&(this===t||!!this.previouslyClippedPaths&&this.previouslyClippedPaths.contains(t))},t.prototype.getInstructionToRecreate=function(){var t=this,n=function(n,e){t.latestClippedPath.execute(n,e)};if(this.previouslyClippedPaths){var e=this.previouslyClippedPaths.getInstructionToRecreate(),i=this.previouslyClippedPaths.latestClippedPath.state.getInstructionToConvertToState(this.latestClippedPath.initialState);return function(t,o){e(t,o),i(t,o),n(t,o)}}return n},t}(),rt=[Y,P,q,G,E,g,Q,$,h,Z,b,S,I],st=function(){function t(t){this.fillStyle=t.fillStyle,this.lineWidth=t.lineWidth,this.lineDash=t.lineDash,this.strokeStyle=t.strokeStyle,this.lineDashOffset=t.lineDashOffset,this.transformation=t.transformation,this.direction=t.direction,this.font=t.font,this.textAlign=t.textAlign,this.textBaseline=t.textBaseline,this.clippedPaths=t.clippedPaths,this.fillAndStrokeStylesTransformed=t.fillAndStrokeStylesTransformed,this.shadowOffset=t.shadowOffset,this.shadowColor=t.shadowColor,this.shadowBlur=t.shadowBlur}return t.prototype.changeProperty=function(n,e){var i=this,o={fillStyle:i.fillStyle,lineWidth:i.lineWidth,lineDash:i.lineDash,strokeStyle:i.strokeStyle,lineDashOffset:i.lineDashOffset,transformation:i.transformation,direction:i.direction,font:i.font,textAlign:i.textAlign,textBaseline:i.textBaseline,clippedPaths:i.clippedPaths,fillAndStrokeStylesTransformed:i.fillAndStrokeStylesTransformed,shadowOffset:i.shadowOffset,shadowColor:i.shadowColor,shadowBlur:i.shadowBlur};return o[n]=e,new t(o)},Object.defineProperty(t.prototype,"clippingRegion",{get:function(){return this.clippedPaths?this.clippedPaths.area:void 0},enumerable:!0,configurable:!0}),t.prototype.equals=function(t){for(var n=0,e=rt;n<e.length;n++){if(!e[n].isEqualForInstances(this,t))return!1}return(!this.clippedPaths&&!t.clippedPaths||this.clippedPaths&&this.clippedPaths===t.clippedPaths)&&this.fillAndStrokeStylesTransformed===t.fillAndStrokeStylesTransformed},t.prototype.getMaximumLineWidth=function(){return this.lineWidth*this.transformation.getMaximumLineWidthScale()},t.prototype.getLineDashPeriod=function(){return this.lineDash.reduce((function(t,n){return t+n}),0)},t.prototype.isTransformable=function(){for(var t=0,n=rt;t<n.length;t++){if(!n[t].valueIsTransformableForInstance(this))return!1}return!0},t.prototype.getInstructionToConvertToState=function(t){var n=this,e=rt.map((function(e){return e.getInstructionToChange(n,t)}));return function(t,n){for(var i=0;i<e.length;i++)e[i](t,n)}},t.prototype.withClippedPath=function(t){var n=this.clippedPaths?this.clippedPaths.withClippedPath(t):new ot(t.getClippedArea(),t);return this.changeProperty("clippedPaths",n)},t.default=new t({fillStyle:"#000",lineWidth:1,lineDash:[],strokeStyle:"#000",lineDashOffset:0,transformation:a.identity,direction:"inherit",font:"10px sans-serif",textAlign:"start",textBaseline:"alphabetic",clippedPaths:void 0,fillAndStrokeStylesTransformed:!1,shadowOffset:s.origin,shadowColor:"rgba(0, 0, 0, 0)",shadowBlur:0}),t.setDefault=function(){},t}(),at=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),ct=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.colorStops=[],n}return at(n,t),n.prototype.addColorStopsToGradient=function(t){for(var n=0,e=this.colorStops;n<e.length;n++){var i=e[n];t.addColorStop(i.offset,i.color)}},n.prototype.addColorStop=function(t,n){this.colorStops.push({offset:t,color:n})},n.prototype.getInstructionToSetTransformed=function(t){var n=this;return function(e,i){e[t]=n.createTransformedGradient(i)}},n.prototype.getInstructionToSetUntransformed=function(t){var n=this;return function(e){e[t]=n.createGradient()}},n}(l),ut=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),ht=function(t){function n(n,e,i,o,r){var s=t.call(this)||this;return s.context=n,s.x0=e,s.y0=i,s.x1=o,s.y1=r,s}return ut(n,t),n.prototype.createTransformedGradient=function(t){var n=t.apply(new s(this.x0,this.y0)),e=n.x,i=n.y,o=t.apply(new s(this.x1,this.y1)),r=o.x,a=o.y,c=this.context.createLinearGradient(e,i,r,a);return this.addColorStopsToGradient(c),c},n.prototype.createGradient=function(){var t=this.context.createLinearGradient(this.x0,this.y0,this.x1,this.y1);return this.addColorStopsToGradient(t),t},n}(ct),pt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),ft=function(t){function n(n,e,i,o,r,s,a){var c=t.call(this)||this;return c.context=n,c.x0=e,c.y0=i,c.r0=o,c.x1=r,c.y1=s,c.r1=a,c}return pt(n,t),n.prototype.createTransformedGradient=function(t){var n=t.apply(new s(this.x0,this.y0)),e=n.x,i=n.y,o=t.apply(new s(this.x1,this.y1)),r=o.x,a=o.y,c=this.r0*t.scale,u=this.r1*t.scale,h=this.context.createRadialGradient(e,i,c,r,a,u);return this.addColorStopsToGradient(h),h},n.prototype.createGradient=function(){var t=this.context.createRadialGradient(this.x0,this.y0,this.r0,this.x1,this.y1,this.r1);return this.addColorStopsToGradient(t),t},n}(ct),lt=function(){function t(t){this.initiallyWithState=t,this.added=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.added.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentlyWithState",{get:function(){return this.addedLast?this.addedLast:this.initiallyWithState},enumerable:!0,configurable:!0}),t.prototype.reconstructState=function(t,n){n.setInitialState(t)},Object.defineProperty(t.prototype,"stateOfFirstInstruction",{get:function(){return this.initiallyWithState.stateOfFirstInstruction},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.currentlyWithState.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initialState",{get:function(){return this.initiallyWithState.initialState},enumerable:!0,configurable:!0}),t.prototype.addClippedPath=function(t){this.currentlyWithState.addClippedPath(t)},t.prototype.add=function(t){this.added.push(t),this.addedLast=t},t.prototype.removeAll=function(t){for(var n;(n=this.added.findIndex(t))>-1;)this.removeAtIndex(n)},t.prototype.contains=function(t){return!!this.added.find(t)},t.prototype.setInitialState=function(t){this.initiallyWithState.setInitialState(t)},t.prototype.setInitialStateWithClippedPaths=function(t){this.initiallyWithState.setInitialStateWithClippedPaths(t)},t.prototype.execute=function(t,n){this.initiallyWithState.execute(t,n);for(var e=0,i=this.added;e<i.length;e++){i[e].execute(t,n)}},t.prototype.beforeIndex=function(t){return 0===t?this.initiallyWithState.state:this.added[t-1].state},t.prototype.removeAtIndex=function(t){t===this.added.length-1?1===this.added.length?this.addedLast=void 0:this.addedLast=this.added[t-1]:this.reconstructState(this.beforeIndex(t),this.added[t+1]),this.added.splice(t,1)},t}(),dt=function(){function t(t){this.currentState=t,this.instructions=[]}return t.prototype.restore=function(){this.addChangeToState(this.currentState.restored(),(function(t){t.restore()}))},t.prototype.save=function(){this.addChangeToState(this.currentState.saved(),(function(t){t.save()}))},t.prototype.changeCurrentInstanceTo=function(t){if(!this.currentState.current.equals(t)){var n=this.currentState.current.getInstructionToConvertToState(t),e=this.currentState.withCurrentState(t);this.addChangeToState(e,n)}},t.prototype.addChangeToState=function(t,n){this.currentState=t,n&&this.instructions.push(n)},Object.defineProperty(t.prototype,"instruction",{get:function(){var t=this;if(0!==this.instructions.length)return function(n,e){for(var i=0,o=t.instructions;i<o.length;i++){(0,o[i])(n,e)}}},enumerable:!0,configurable:!0}),t}(),yt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),vt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return yt(n,t),n.prototype.changeCurrentInstanceTo=function(e){if(!this.currentState.current.equals(e)){if(!n.canConvert(this.currentState.current,e)){if(!(this.currentState.stack.length>0))return void t.prototype.changeCurrentInstanceTo.call(this,e);this.restore(),this.save()}if(e.clippedPaths){var i=this.currentState,o=i.current.clippedPaths;if(e.clippedPaths===o)t.prototype.changeCurrentInstanceTo.call(this,e);else{var r=e.clippedPaths.except(o);this.convertToState(r.initialState),this.addChangeToState(r.latestClippedPath.state,r.getInstructionToRecreate()),this.convertToState(i.replaceCurrent(e))}}else t.prototype.changeCurrentInstanceTo.call(this,e)}},n.prototype.convertToState=function(t){var n=this.currentState.getInstructionToConvertToState(t);this.addChangeToState(t,n)},n.canConvert=function(t,n){return!t.clippedPaths||!!n.clippedPaths&&n.clippedPaths.contains(t.clippedPaths)},n}(dt),Pt=new(function(){function t(t,n){void 0===n&&(n=[]),this.current=t,this.stack=n}return t.prototype.replaceCurrent=function(n){return new t(n,this.stack)},t.prototype.withCurrentState=function(n){return new t(n,this.stack)},t.prototype.currentlyTransformed=function(t){return this.withCurrentState(this.current.changeProperty("fillAndStrokeStylesTransformed",t))},t.prototype.withClippedPath=function(n){return new t(this.current.withClippedPath(n),this.stack)},t.prototype.saved=function(){return new t(this.current,(this.stack||[]).concat([this.current]))},t.prototype.restored=function(){return this.stack&&0!==this.stack.length?new t(this.stack[this.stack.length-1],this.stack.slice(0,this.stack.length-1)):this},t.prototype.convertToLastSavedInstance=function(t,n){for(var e=this.stack.length-1;e>n;e--)t.restore()},t.prototype.convertFromLastSavedInstance=function(t,n){for(var e=n+1;e<this.stack.length;e++)t.changeCurrentInstanceTo(this.stack[e]),t.save();t.changeCurrentInstanceTo(this.current)},t.prototype.getInstructionToConvertToStateUsingConversion=function(n,e){var i=t.findIndexOfHighestCommon(this.stack,e.stack);return this.convertToLastSavedInstance(n,i),e.convertFromLastSavedInstance(n,i),n.instruction},t.prototype.getInstructionToConvertToState=function(t){return this.getInstructionToConvertToStateUsingConversion(new dt(this),t)},t.prototype.getInstructionToClearStack=function(){var t=this.stack.length;return function(n){for(var e=0;e<t;e++)n.restore()}},t.prototype.getInstructionToConvertToStateWithClippedPath=function(t){return this.getInstructionToConvertToStateUsingConversion(new vt(this),t)},t.findIndexOfHighestCommon=function(t,n){for(var e=0,i=Math.min(t.length-1,n.length-1);e<=i;){if(!t[e].equals(n[e]))return e-1;e++}return e-1},t}())(st.default,[]),gt=function(){function t(t,n){this.initialState=t,this.state=n,this.stateConversion=function(){}}return t.prototype.setInitialState=function(t){this.initialState=t;var n=this.initialState.getInstructionToConvertToState(this.state);this.stateConversion=n},Object.defineProperty(t.prototype,"stateOfFirstInstruction",{get:function(){return this.state},enumerable:!0,configurable:!0}),t.prototype.addClippedPath=function(t){this.state=this.state.withClippedPath(t)},t.prototype.setInitialStateWithClippedPaths=function(t){this.initialState=t;var n=this.initialState.getInstructionToConvertToStateWithClippedPath(this.state);this.stateConversion=n},t.prototype.execute=function(t,n){this.stateConversion&&this.stateConversion(t,n),this.executeInstruction(t,n)},t}(),mt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),wt=function(t){function n(n,e,i,o){var r=t.call(this,n,e)||this;return r.instruction=i,r.stateConversion=o,r}return mt(n,t),n.prototype.executeInstruction=function(t,n){this.instruction(t,n)},n.prototype.copy=function(){return new n(this.initialState,this.state,this.instruction,this.stateConversion)},n.create=function(t,e){return new n(t,t,e,(function(){}))},n}(gt),It=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Tt=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o)||this;return s.area=r,s}return It(n,t),n.prototype.hasDrawingAcrossBorderOf=function(t){return!1},n.prototype.intersects=function(t){return this.area.intersects(t)},n.prototype.isContainedBy=function(t){return t.contains(this.area)},n.createClearRect=function(t,e,i,o,r,s,a){return new n(t,t,(function(t){i.clearRect(t,o,r,s,a)}),(function(){}),e)},n}(wt),bt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),xt=function(t){function n(n,e){var i=t.call(this,n)||this;return i.viewboxInfinityProvider=e,i}return bt(n,t),n.prototype.reconstructState=function(t,n){n.setInitialStateWithClippedPaths(t)},n.prototype.hasDrawingAcrossBorderOf=function(t){return this.contains((function(n){return n.hasDrawingAcrossBorderOf(t)}))},n.prototype.intersects=function(t){return this.contains((function(n){return n.intersects(t)}))},n.prototype.addClearRect=function(t,n,e,i,o,r){var s=this.viewboxInfinityProvider.getForPath().getInfinity(n),a=Tt.createClearRect(n,t,s,e,i,o,r);a.setInitialState(this.state),this.add(a)},n.prototype.clearContentsInsideArea=function(t){this.removeAll((function(n){return n.isContainedBy(t)}))},n.prototype.isContainedBy=function(t){return!this.contains((function(n){return!n.isContainedBy(t)}))},n.create=function(t){return new n(wt.create(Pt,st.setDefault),t)},n}(lt);function St(t){return void 0!==t.direction}function Ct(t,n){return St(t)?n.applyToPointAtInfinity(t):n.apply(t)}var Bt=function(){function t(t,n){this.areaBuilder=t,this.transformation=n}return t.prototype.addPosition=function(t){this.areaBuilder.addPosition(Ct(t,this.transformation))},t}(),Ot=new(function(){function t(){}return t.prototype.intersectWith=function(t){return this},t.prototype.intersectWithConvexPolygon=function(t){return this},t.prototype.intersects=function(t){return!1},t.prototype.intersectWithLineSegment=function(t){return this},t.prototype.intersectWithRay=function(t){return this},t.prototype.intersectWithLine=function(t){return this},t.prototype.expandToInclude=function(t){return t},t.prototype.transform=function(t){return this},t.prototype.contains=function(t){return!1},t.prototype.isContainedByConvexPolygon=function(t){return!0},t.prototype.isContainedByRay=function(t){return!0},t.prototype.isContainedByLineSegment=function(t){return!0},t.prototype.isContainedByLine=function(t){return!0},t.prototype.intersectsRay=function(t){return!1},t.prototype.intersectsConvexPolygon=function(t){return!1},t.prototype.intersectsLineSegment=function(t){return!1},t.prototype.intersectsLine=function(t){return!1},t.prototype.expandToIncludePoint=function(t){return this},t.prototype.expandToIncludeInfinityInDirection=function(t){return this},t.prototype.expandToIncludePolygon=function(t){return t},t}()),_t=function(){function t(t,n){this.base=t,this.direction=n}return t.prototype.pointIsOnSameLine=function(t){return 0===t.minus(this.base).cross(this.direction)},t.prototype.comesBefore=function(t,n){return n.minus(t).dot(this.direction)>=0},t.prototype.lineSegmentIsOnSameLine=function(t){return 0===this.direction.cross(t.direction)&&this.pointIsOnSameLine(t.point1)},t.prototype.getPointsInSameDirection=function(t,n){return this.comesBefore(n,t)?{point1:n,point2:t}:{point1:t,point2:n}},t.prototype.pointIsBetweenPoints=function(t,n,e){return t.minus(n).dot(this.direction)*t.minus(e).dot(this.direction)<=0},t.prototype.intersectsConvexPolygon=function(t){if(this.isContainedByConvexPolygon(t))return!0;for(var n=0,e=t.getIntersectionsWithLine(this.base,this.direction);n<e.length;n++){var i=e[n];if(this.interiorContainsPoint(i.point))return!0}return!1},t}(),At=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Dt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return At(n,t),n.prototype.intersectWith=function(t){return t.intersectWithLine(this)},n.prototype.intersectWithConvexPolygon=function(t){if(!this.intersectsConvexPolygon(t))return Ot;if(this.isContainedByConvexPolygon(t))return this;for(var n,e,i=0,o=t.getIntersectionsWithLine(this.base,this.direction);i<o.length;i++){var r=o[i];(!n&&!e||!n&&this.comesBefore(r.point,e)||!e&&this.comesBefore(n,r.point)||n&&e&&this.pointIsBetweenPoints(r.point,n,e))&&(r.halfPlane.normalTowardInterior.dot(this.direction)>0?n=r.point:e=r.point)}return n&&e?new jt(n,e):n?new Ft(n,this.direction):new Ft(e,this.direction.scale(-1))},n.prototype.intersectWithLine=function(t){return this.intersectsLine(t)?this:Ot},n.prototype.intersectWithLineSegment=function(t){return this.lineSegmentIsOnSameLine(t)?t:Ot},n.prototype.intersectWithRay=function(t){return this.intersectsRay(t)?t:Ot},n.prototype.isContainedByConvexPolygon=function(t){return t.containsPoint(this.base)&&t.containsInfinityInDirection(this.direction)&&t.containsInfinityInDirection(this.direction.scale(-1))},n.prototype.isContainedByLine=function(t){return this.intersectsSubsetOfLine(t)},n.prototype.isContainedByLineSegment=function(t){return!1},n.prototype.isContainedByRay=function(t){return!1},n.prototype.contains=function(t){return t.isContainedByLine(this)},n.prototype.intersectsLine=function(t){return this.intersectsSubsetOfLine(t)},n.prototype.intersectsSubsetOfLine=function(t){return this.pointIsOnSameLine(t.base)&&0===this.direction.cross(t.direction)},n.prototype.intersectsLineSegment=function(t){return this.lineSegmentIsOnSameLine(t)},n.prototype.intersectsRay=function(t){return this.intersectsSubsetOfLine(t)},n.prototype.intersects=function(t){return t.intersectsLine(this)},n.prototype.expandToIncludePoint=function(t){return this.pointIsOnSameLine(t)?this:W.createFromHalfPlane(L.throughPointsAndContainingPoint(this.base,this.base.plus(this.direction),t))},n.prototype.expandToIncludeInfinityInDirection=function(t){var n=t.cross(this.direction),e=this.direction.getPerpendicular();return 0===n?this:n>0?W.createFromHalfPlane(new L(this.base,e.scale(-1))):W.createFromHalfPlane(new L(this.base,e))},n.prototype.transform=function(t){var e=t.apply(this.base);return new n(e,t.apply(this.base.plus(this.direction)).minus(e))},n.prototype.interiorContainsPoint=function(t){return this.pointIsOnSameLine(t)},n}(_t),Lt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ft=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Lt(n,t),n.prototype.intersectWith=function(t){return t.intersectWithRay(this)},n.prototype.intersectWithConvexPolygon=function(t){if(!this.intersectsConvexPolygon(t))return Ot;if(this.isContainedByConvexPolygon(t))return this;for(var e,i=t.getIntersectionsWithLine(this.base,this.direction),o=this.base,r=0,s=i;r<s.length;r++){var a=s[r];(!e&&this.comesBefore(o,a.point)||e&&this.pointIsBetweenPoints(a.point,o,e))&&(a.halfPlane.normalTowardInterior.dot(this.direction)>0?o=a.point:e=a.point)}return e?new jt(o,e):new n(o,this.direction)},n.prototype.intersectWithRay=function(t){return this.isContainedByRay(t)?this:t.isContainedByRay(this)?t:this.interiorContainsPoint(t.base)?new jt(this.base,t.base):Ot},n.prototype.intersectWithLine=function(t){return t.intersectWithRay(this)},n.prototype.intersectWithLineSegment=function(t){if(t.isContainedByRay(this))return t;if(!this.lineSegmentIsOnSameLine(t))return Ot;var n=this.getPointsInSameDirection(t.point1,t.point2).point2;return this.comesBefore(n,this.base)?Ot:new jt(this.base,n)},n.prototype.isContainedByConvexPolygon=function(t){return t.containsPoint(this.base)&&t.containsInfinityInDirection(this.direction)},n.prototype.isContainedByRay=function(t){return t.containsPoint(this.base)&&t.containsInfinityInDirection(this.direction)},n.prototype.isContainedByLine=function(t){return t.intersectsSubsetOfLine(this)},n.prototype.isContainedByLineSegment=function(t){return!1},n.prototype.contains=function(t){return t.isContainedByRay(this)},n.prototype.intersectsRay=function(t){return this.isContainedByRay(t)||t.isContainedByRay(this)||this.interiorContainsPoint(t.base)},n.prototype.intersectsLine=function(t){return t.intersectsSubsetOfLine(this)},n.prototype.intersectsLineSegment=function(t){if(t.isContainedByRay(this))return!0;if(!this.lineSegmentIsOnSameLine(t))return!1;var n=this.getPointsInSameDirection(t.point1,t.point2).point2;return!this.comesBefore(n,this.base)},n.prototype.intersects=function(t){return t.intersectsRay(this)},n.prototype.expandToIncludePoint=function(t){return this.containsPoint(t)?this:this.pointIsOnSameLine(t)?new n(t,this.direction):W.createTriangleWithInfinityInDirection(this.base,t,this.direction)},n.prototype.expandToIncludeInfinityInDirection=function(t){return t.inSameDirectionAs(this.direction)?this:0===this.direction.cross(t)?new Dt(this.base,this.direction):W.createTriangleWithInfinityInTwoDirections(this.base,this.direction,t)},n.prototype.transform=function(t){var e=t.apply(this.base);return new n(e,t.apply(this.base.plus(this.direction)).minus(e))},n.prototype.interiorContainsPoint=function(t){return this.pointIsOnSameLine(t)&&!this.comesBefore(t,this.base)},n.prototype.containsInfinityInDirection=function(t){return this.direction.inSameDirectionAs(t)},n.prototype.containsPoint=function(t){return this.pointIsOnSameLine(t)&&this.comesBefore(this.base,t)},n}(_t),Wt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),jt=function(t){function n(n,e){var i=t.call(this,n,e.minus(n))||this;return i.point1=n,i.point2=e,i}return Wt(n,t),n.prototype.intersectWith=function(t){return t.intersectWithLineSegment(this)},n.prototype.intersectWithLineSegment=function(t){if(this.isContainedByLineSegment(t))return this;if(t.isContainedByLineSegment(this))return t;if(!this.lineSegmentIsOnSameLine(t))return Ot;var e=this.getPointsInSameDirection(t.point1,t.point2),i=e.point1,o=e.point2;return this.comesBefore(o,this.point1)||this.comesBefore(this.point2,i)?Ot:this.comesBefore(this.point1,i)?new n(i,this.point2):new n(this.point1,o)},n.prototype.intersectWithRay=function(t){return t.intersectWithLineSegment(this)},n.prototype.intersectWithLine=function(t){return t.intersectWithLineSegment(this)},n.prototype.isContainedByRay=function(t){return t.containsPoint(this.point1)&&t.containsPoint(this.point2)},n.prototype.isContainedByLine=function(t){return t.intersectsSubsetOfLine(this)},n.prototype.isContainedByLineSegment=function(t){return t.containsPoint(this.point1)&&t.containsPoint(this.point2)},n.prototype.intersectWithConvexPolygon=function(t){if(!this.intersectsConvexPolygon(t))return Ot;if(this.isContainedByConvexPolygon(t))return this;for(var e=t.getIntersectionsWithLine(this.point1,this.direction),i=this.point1,o=this.point2,r=0,s=e;r<s.length;r++){var a=s[r];this.pointIsBetweenPoints(a.point,i,o)&&(a.halfPlane.normalTowardInterior.dot(this.direction)>0?i=a.point:o=a.point)}return new n(i,o)},n.prototype.isContainedByConvexPolygon=function(t){return t.containsPoint(this.point1)&&t.containsPoint(this.point2)},n.prototype.contains=function(t){return t.isContainedByLineSegment(this)},n.prototype.pointIsStrictlyBetweenPoints=function(t,n,e){return t.minus(n).dot(this.direction)*t.minus(e).dot(this.direction)<0},n.prototype.containsPoint=function(t){return this.pointIsOnSameLine(t)&&this.pointIsBetweenPoints(t,this.point1,this.point2)},n.prototype.interiorContainsPoint=function(t){return this.pointIsOnSameLine(t)&&this.pointIsStrictlyBetweenPoints(t,this.point1,this.point2)},n.prototype.intersectsRay=function(t){return t.intersectsLineSegment(this)},n.prototype.intersectsLineSegment=function(t){if(this.isContainedByLineSegment(t)||t.isContainedByLineSegment(this))return!0;if(!this.lineSegmentIsOnSameLine(t))return!1;var n=this.getPointsInSameDirection(t.point1,t.point2),e=n.point1,i=n.point2;return!this.comesBefore(i,this.point1)&&!this.comesBefore(this.point2,e)},n.prototype.intersectsLine=function(t){return t.intersectsSubsetOfLine(this)},n.prototype.intersects=function(t){return t.intersectsLineSegment(this)},n.prototype.expandToIncludePoint=function(t){return this.containsPoint(t)?this:this.pointIsOnSameLine(t)?this.comesBefore(t,this.point1)?new n(t,this.point2):new n(this.point1,t):W.createTriangle(this.point1,t,this.point2)},n.prototype.expandToIncludeInfinityInDirection=function(t){return t.inSameDirectionAs(this.direction)?new Ft(this.point1,t):0===t.cross(this.direction)?new Ft(this.point2,t):W.createTriangleWithInfinityInDirection(this.point1,this.point2,t)},n.prototype.transform=function(t){return new n(t.apply(this.point1),t.apply(this.point2))},n}(_t),Rt=new(function(){function t(){}return t.prototype.addPoint=function(t){return F},t.prototype.addPointAtInfinity=function(t){return this},t.prototype.addArea=function(t){return F},t}()),kt=function(){function t(t){this.towardsMiddle=t}return t.prototype.addPoint=function(t){return W.createFromHalfPlane(new L(t,this.towardsMiddle))},t.prototype.addPointAtInfinity=function(t){return t.dot(this.towardsMiddle)>=0?this:Rt},t.prototype.addArea=function(t){var n=this.towardsMiddle.getPerpendicular();return t.expandToIncludeInfinityInDirection(this.towardsMiddle).expandToIncludeInfinityInDirection(n).expandToIncludeInfinityInDirection(n.scale(-1))},t}(),Nt=function(){function t(t,n){this.direction1=t,this.direction2=n}return t.prototype.addPoint=function(t){return W.createTriangleWithInfinityInTwoDirections(t,this.direction1,this.direction2)},t.prototype.addPointAtInfinity=function(n){return n.isInSmallerAngleBetweenPoints(this.direction1,this.direction2)?this:0===n.cross(this.direction1)?new kt(this.direction2.projectOn(this.direction1.getPerpendicular())):0===n.cross(this.direction2)?new kt(this.direction1.projectOn(this.direction2.getPerpendicular())):this.direction1.isInSmallerAngleBetweenPoints(n,this.direction2)?new t(n,this.direction2):this.direction2.isInSmallerAngleBetweenPoints(n,this.direction1)?new t(n,this.direction1):Rt},t.prototype.addArea=function(t){return t.expandToIncludeInfinityInDirection(this.direction1).expandToIncludeInfinityInDirection(this.direction2)},t}(),Vt=function(){function t(t){this.direction=t}return t.prototype.addPoint=function(t){return new Dt(t,this.direction)},t.prototype.addPointAtInfinity=function(t){return 0===t.cross(this.direction)?this:new kt(t.projectOn(this.direction.getPerpendicular()))},t.prototype.addArea=function(t){return t.expandToIncludeInfinityInDirection(this.direction).expandToIncludeInfinityInDirection(this.direction.scale(-1))},t}(),Mt=function(){function t(t){this.direction=t}return t.prototype.addPointAtInfinity=function(t){return t.inSameDirectionAs(this.direction)?this:0===t.cross(this.direction)?new Vt(this.direction):new Nt(this.direction,t)},t.prototype.addPoint=function(t){return new Ft(t,this.direction)},t.prototype.addArea=function(t){return t.expandToIncludeInfinityInDirection(this.direction)},t}(),Et=function(){function t(t,n,e){this._area=t,this.firstPoint=n,this.subsetOfLineAtInfinity=e}return Object.defineProperty(t.prototype,"area",{get:function(){return this._area||Ot},enumerable:!0,configurable:!0}),t.prototype.addPoint=function(t){this._area?this._area=this._area.expandToIncludePoint(t):this.firstPoint?t.equals(this.firstPoint)||(this._area=new jt(this.firstPoint,t)):this.subsetOfLineAtInfinity?this._area=this.subsetOfLineAtInfinity.addPoint(t):this.firstPoint=t},t.prototype.addPosition=function(t){St(t)?this.addInfinityInDirection(t.direction):this.addPoint(t)},t.prototype.addInfinityInDirection=function(t){this._area?this._area=this._area.expandToIncludeInfinityInDirection(t):this.firstPoint?this._area=new Ft(this.firstPoint,t):this.subsetOfLineAtInfinity?(this.subsetOfLineAtInfinity=this.subsetOfLineAtInfinity.addPointAtInfinity(t),this.subsetOfLineAtInfinity===Rt&&(this._area=F)):this.subsetOfLineAtInfinity=new Mt(t)},t.prototype.transformedWith=function(t){return new Bt(this,t)},t.prototype.copy=function(){return new t(this._area,this.firstPoint,this.subsetOfLineAtInfinity)},t}(),qt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ht=function(t){function n(n,e,i,o,r){var s=t.call(this,n,i)||this;return s.infinity=e,s.instruction=o,s.stateConversion=r,s}return qt(n,t),n.prototype.executeInstruction=function(t,n){this.instruction(t,n,this.infinity)},n.prototype.replaceInstruction=function(t){this.instruction=t},n.prototype.copy=function(t){return new n(this.initialState,t.getInfinity(this.state),this.state,this.instruction,this.stateConversion)},n.create=function(t,e,i){return new n(t,e,t,i,(function(){}))},n}(gt);var Gt=function(){function t(t){this.shape=t}return t.prototype.getInstructionToDrawLineTo=function(t,n){return this.getInstructionToExtendShapeWithLineTo(this.shape.transform(n.current.transformation.inverse()),t)},t.prototype.getInstructionToMoveToBeginning=function(t){return this.getInstructionToMoveToBeginningOfShape(this.shape.transform(t.current.transformation.inverse()))},Object.defineProperty(t.prototype,"currentPosition",{get:function(){return this.shape.currentPosition},enumerable:!0,configurable:!0}),t.prototype.moveToInfinityFromPointInDirection=function(t,n){return function(e,i,o){o.moveToInfinityFromPointInDirection(e,t,n)}},t.prototype.lineFromInfinityFromPointToInfinityFromPoint=function(t,n,e){return function(i,o,r){r.drawLineFromInfinityFromPointToInfinityFromPoint(i,t,n,e)}},t.prototype.lineFromInfinityFromPointToPoint=function(t,n){return function(e,i,o){o.drawLineFromInfinityFromPointToPoint(e,t,n)}},t.prototype.lineToInfinityFromPointInDirection=function(t,n){return function(e,i,o){o.drawLineToInfinityFromPointInDirection(e,t,n)}},t.prototype.lineToInfinityFromInfinityFromPoint=function(t,n,e){return function(i,o,r){r.drawLineToInfinityFromInfinityFromPoint(i,t,n,e)}},t.prototype.lineTo=function(t){return function(n,e){var i=e.apply(t),o=i.x,r=i.y;n.lineTo(o,r)}},t.prototype.moveTo=function(t){return function(n,e){var i=e.apply(t),o=i.x,r=i.y;n.moveTo(o,r)}},t}(),zt=function(){function t(t,n,e,i){this.initialPosition=t,this.firstFinitePoint=n,this.lastFinitePoint=e,this.currentPosition=i}return t.prototype.transform=function(n){return new t(n.applyToPointAtInfinity(this.initialPosition),n.apply(this.firstFinitePoint),n.apply(this.lastFinitePoint),n.applyToPointAtInfinity(this.currentPosition))},t}(),Ut=function(){function t(t,n,e){this.initialPosition=t,this.firstFinitePoint=n,this.currentPosition=e}return t.prototype.transform=function(n){return new t(n.applyToPointAtInfinity(this.initialPosition),n.apply(this.firstFinitePoint),n.apply(this.currentPosition))},t}();function Yt(t){return function(n,e){var i=e.a,o=e.b,r=e.c,s=e.d,a=e.e,c=e.f;n.save(),n.transform(i,o,r,s,a,c),t(n,e),n.restore()}}function Xt(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n,e,i){for(var o=0,r=t;o<r.length;o++){(0,r[o])(n,e,i)}}}var Zt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Jt=function(t){function n(n,e){var i=t.call(this,e)||this;return i.pathBuilderProvider=n,i}return Zt(n,t),n.prototype.getInstructionToMoveToBeginningOfShape=function(t){return 0===t.initialPosition.direction.cross(t.currentPosition.direction)?this.moveToInfinityFromPointInDirection(t.firstFinitePoint,t.initialPosition.direction):Xt(this.moveToInfinityFromPointInDirection(t.lastFinitePoint,t.currentPosition.direction),this.lineToInfinityFromInfinityFromPoint(t.lastFinitePoint,t.currentPosition.direction,t.initialPosition.direction),this.lineFromInfinityFromPointToInfinityFromPoint(t.lastFinitePoint,t.firstFinitePoint,t.initialPosition.direction))},n.prototype.getInstructionToExtendShapeWithLineTo=function(t,n){return St(n)?this.lineToInfinityFromInfinityFromPoint(t.lastFinitePoint,t.currentPosition.direction,n.direction):Xt(this.lineFromInfinityFromPointToInfinityFromPoint(this.shape.lastFinitePoint,n,t.currentPosition.direction),this.lineFromInfinityFromPointToPoint(n,t.currentPosition.direction))},n.prototype.containsFinitePoint=function(){return!0},n.prototype.isClosable=function(){return!this.shape.initialPosition.direction.isInOppositeDirectionAs(this.shape.currentPosition.direction)},n.prototype.canAddLineTo=function(t){return!St(t)||!t.direction.isInOppositeDirectionAs(this.shape.currentPosition.direction)},n.prototype.addPosition=function(t){return St(t)?this.pathBuilderProvider.fromPointAtInfinityToPointAtInfinity(new zt(this.shape.initialPosition,this.shape.firstFinitePoint,this.shape.lastFinitePoint,t)):this.pathBuilderProvider.fromPointAtInfinityToPoint(new Ut(this.shape.initialPosition,this.shape.firstFinitePoint,t))},n}(Gt),Qt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Kt=function(t){function n(n,e){var i=t.call(this,e)||this;return i.pathBuilderProvider=n,i}return Qt(n,t),n.prototype.getInstructionToMoveToBeginningOfShape=function(t){var n=this.moveToInfinityFromPointInDirection(t.currentPosition,t.initialPosition.direction);return t.currentPosition.equals(t.firstFinitePoint)?n:Xt(n,this.lineFromInfinityFromPointToInfinityFromPoint(t.currentPosition,t.firstFinitePoint,t.initialPosition.direction))},n.prototype.getInstructionToExtendShapeWithLineTo=function(t,n){return St(n)?this.lineToInfinityFromPointInDirection(t.currentPosition,n.direction):this.lineTo(n)},n.prototype.canAddLineTo=function(t){return!0},n.prototype.containsFinitePoint=function(){return!0},n.prototype.isClosable=function(){return!0},n.prototype.addPosition=function(t){return St(t)?this.pathBuilderProvider.fromPointAtInfinityToPointAtInfinity(new zt(this.shape.initialPosition,this.shape.firstFinitePoint,this.shape.currentPosition,t)):this.pathBuilderProvider.fromPointAtInfinityToPoint(new Ut(this.shape.initialPosition,this.shape.firstFinitePoint,t))},n}(Gt),$t=function(){function t(t,n){this.initialPoint=t,this.currentPosition=n}return t.prototype.transform=function(n){return new t(n.apply(this.initialPoint),n.applyToPointAtInfinity(this.currentPosition))},t}(),tn=function(){function t(t,n){this.initialPoint=t,this.currentPosition=n}return t.prototype.transform=function(n){return new t(n.apply(this.initialPoint),n.apply(this.currentPosition))},t}(),nn=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),en=function(t){function n(n,e){var i=t.call(this,e)||this;return i.pathBuilderProvider=n,i}return nn(n,t),n.prototype.getInstructionToMoveToBeginningOfShape=function(t){return this.moveTo(t.initialPoint)},n.prototype.getInstructionToExtendShapeWithLineTo=function(t,n){return St(n)?n.direction.inSameDirectionAs(t.currentPosition.direction)?function(){}:this.lineToInfinityFromInfinityFromPoint(t.initialPoint,t.currentPosition.direction,n.direction):Xt(this.lineFromInfinityFromPointToInfinityFromPoint(this.shape.initialPoint,n,t.currentPosition.direction),this.lineFromInfinityFromPointToPoint(n,t.currentPosition.direction))},n.prototype.canAddLineTo=function(t){return!St(t)||!t.direction.isInOppositeDirectionAs(this.shape.currentPosition.direction)},n.prototype.containsFinitePoint=function(){return!0},n.prototype.isClosable=function(){return!0},n.prototype.addPosition=function(t){return St(t)?this.pathBuilderProvider.fromPointToPointAtInfinity(new $t(this.shape.initialPoint,t)):this.pathBuilderProvider.fromPointToPoint(new tn(this.shape.initialPoint,t))},n}(Gt),on=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),rn=function(t){function n(n,e){var i=t.call(this,e)||this;return i.pathBuilderProvider=n,i}return on(n,t),n.prototype.getInstructionToMoveToBeginningOfShape=function(t){return this.moveTo(t.initialPoint)},n.prototype.getInstructionToExtendShapeWithLineTo=function(t,n){if(St(n)){var e=this.lineToInfinityFromPointInDirection(t.currentPosition,n.direction);return 0===t.currentPosition.minus(t.initialPoint).cross(n.direction)?e:Xt(e,this.lineFromInfinityFromPointToInfinityFromPoint(t.currentPosition,t.initialPoint,n.direction))}return this.lineTo(n)},n.prototype.canAddLineTo=function(t){return!0},n.prototype.containsFinitePoint=function(){return!0},n.prototype.isClosable=function(){return!0},n.prototype.addPosition=function(t){return St(t)?this.pathBuilderProvider.fromPointToPointAtInfinity(new $t(this.shape.initialPoint,t)):this.pathBuilderProvider.fromPointToPoint(new tn(this.shape.initialPoint,t))},n}(Gt),sn=function(){function t(t,n,e,i){this.initialPosition=t,this.containsFinitePoint=n,this.positionsSoFar=e,this.currentPosition=i}return t.prototype.transform=function(n){return new t(n.applyToPointAtInfinity(this.initialPosition),this.containsFinitePoint,this.positionsSoFar.map((function(t){return n.applyToPointAtInfinity(t)})),n.applyToPointAtInfinity(this.currentPosition))},t}(),an=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),cn=function(t){function n(n,e,i){var o=t.call(this,i)||this;return o.pathBuilderProvider=n,o.instructionToGoAroundViewbox=e,o}return an(n,t),n.prototype.getInstructionToMoveToBeginningOfShape=function(t){return t.containsFinitePoint?this.instructionToGoAroundViewbox:function(){}},n.prototype.getInstructionToExtendShapeWithLineTo=function(t,n){if(!St(n)){if(1===t.positionsSoFar.length)return this.lineFromInfinityFromPointToPoint(n,t.positionsSoFar[0].direction);for(var e,i=t.positionsSoFar.slice(1),o=t.initialPosition,r=[],s=0,a=i;s<a.length;s++){var c=a[s];r.push(this.lineToInfinityFromInfinityFromPoint(n,o.direction,c.direction)),o=c}return Xt((e=r,function(t,n,i){for(var o=0,r=e;o<r.length;o++)(0,r[o])(t,n,i)}),this.lineFromInfinityFromPointToPoint(n,o.direction))}},n.prototype.canAddLineTo=function(t){return!St(t)||!t.direction.isInOppositeDirectionAs(this.shape.currentPosition.direction)},n.prototype.containsFinitePoint=function(){return this.shape.containsFinitePoint},n.prototype.isClosable=function(){return!0},n.prototype.addPosition=function(t){if(St(t)){var n=t.direction.isOnSameSideOfOriginAs(this.shape.initialPosition.direction,this.shape.currentPosition.direction)?this.shape.containsFinitePoint:!this.shape.containsFinitePoint;return this.pathBuilderProvider.atInfinity(new sn(this.shape.initialPosition,n,this.shape.positionsSoFar.concat([t]),t))}return this.pathBuilderProvider.fromPointAtInfinityToPoint(new Ut(this.shape.initialPosition,t,t))},n}(Gt),un=function(){function t(t){this.instructionToGoAroundViewbox=t}return t.prototype.fromPointAtInfinityToPointAtInfinity=function(t){return new Jt(this,t)},t.prototype.fromPointAtInfinityToPoint=function(t){return new Kt(this,t)},t.prototype.fromPointToPointAtInfinity=function(t){return new en(this,t)},t.prototype.fromPointToPoint=function(t){return new rn(this,t)},t.prototype.atInfinity=function(t){return new cn(this,this.instructionToGoAroundViewbox,t)},t.prototype.getBuilderFromPosition=function(t){return St(t)?new cn(this,this.instructionToGoAroundViewbox,new sn(t,!1,[t],t)):new rn(this,new tn(t,t))},t}(),hn=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),pn=function(t){function n(n,e,i){var o=t.call(this,n)||this;return o._initiallyWithState=n,o.pathInfinityProvider=e,o.pathInstructionBuilder=i,o}return hn(n,t),n.prototype.addInstruction=function(t){t.setInitialState(this.state),this.add(t)},n.prototype.closePath=function(){var t=wt.create(this.state,(function(t){t.closePath()}));t.setInitialState(this.state),this.add(t)},n.prototype.copy=function(t){for(var e=new n(this._initiallyWithState.copy(t),t,this.pathInstructionBuilder),i=0,o=this.added;i<o.length;i++){var r=o[i];e.add(r.copy(t))}return e},n.prototype.containsFinitePoint=function(){return this.pathInstructionBuilder.containsFinitePoint()},n.prototype.isClosable=function(){return this.pathInstructionBuilder.isClosable()},n.prototype.canAddLineTo=function(t){return this.pathInstructionBuilder.canAddLineTo(t)},n.prototype.lineTo=function(t,n){var e=Ct(t,n.current.transformation);St(t)&&!this.pathInstructionBuilder.containsFinitePoint()||this.addInstructionToDrawLineTo(t,n),this.pathInstructionBuilder=this.pathInstructionBuilder.addPosition(e);var i=this.pathInstructionBuilder.getInstructionToMoveToBeginning(this._initiallyWithState.state);this._initiallyWithState.replaceInstruction((function(t,n,e){i(t,n,e)}))},n.prototype.addInstructionToDrawLineTo=function(t,n){var e=this.pathInstructionBuilder.getInstructionToDrawLineTo(t,n),i=this.pathInfinityProvider.getInfinity(n),o=Ht.create(n,i,e);o.setInitialState(this.state),this.add(o)},n.prototype.addPathInstruction=function(t,n,e){var i,o;!t.initialPoint||(i=this.pathInstructionBuilder.currentPosition,o=t.initialPoint,i?o?St(i)?St(o)&&i.direction.equals(o.direction):!St(o)&&i.equals(o):!i:!o)||this.lineTo(t.initialPoint,e),t.positionChange&&(this.pathInstructionBuilder=this.pathInstructionBuilder.addPosition(Ct(t.positionChange,e.current.transformation))),n.setInitialState(this.state),this.add(n)},n.create=function(t,e,i){var o=Ct(e,t.current.transformation),r=i.getPathInstructionToGoAroundViewbox(),s=new un(r).getBuilderFromPosition(o),a=s.getInstructionToMoveToBeginning(t),c=i.getInfinity(t);return new n(Ht.create(t,c,a),i,s)},n}(lt),fn={direction:new s(0,1)},ln={direction:new s(0,-1)},dn={direction:new s(-1,0)},yn={direction:new s(1,0)};function vn(t,n){return!!Number.isFinite(t)||!Number.isFinite(n)&&(t<0&&n>0||t>0&&n<0)}function Pn(t,n,e,i){return vn(t,e)&&vn(n,i)}var gn=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),mn=function(t){function n(n,e,i){var o=t.call(this,n)||this;return o._initiallyWithState=n,o.viewboxInfinityProvider=e,o.pathInfinityProvider=i,o.areaBuilder=new Et,o}return gn(n,t),Object.defineProperty(n.prototype,"area",{get:function(){return this.areaBuilder.area},enumerable:!0,configurable:!0}),n.prototype.getCurrentlyDrawableArea=function(){if(this.area)return this.state.current.clippingRegion?this.state.current.clippingRegion.intersectWith(this.area):this.area},n.prototype.containsFinitePoint=function(){for(var t=0,n=this.added;t<n.length;t++){if(n[t].containsFinitePoint())return!0}return!1},n.prototype.currentSubpathIsClosable=function(){return 0===this.added.length||this.added[this.added.length-1].isClosable()},n.prototype.allSubpathsAreClosable=function(){if(0===this.added.length)return!0;for(var t=0,n=this.added;t<n.length;t++){if(!n[t].isClosable())return!1}return!0},n.prototype.fillPath=function(t,n){this.drawPath(t,n)},n.prototype.strokePath=function(t,n){this.pathInfinityProvider.addDrawnLineWidth(n.current.getMaximumLineWidth()),this.pathInfinityProvider.addLineDashPeriod(n.current.getLineDashPeriod()),this.drawPath(t,n)},n.prototype.drawPath=function(t,n){if(0!==this.added.length){var e=this.added[this.added.length-1],i=this.getCurrentlyDrawableArea();this.drawnArea=i;var o=wt.create(n,t);e.addInstruction(o)}},n.prototype.clipPath=function(t,n){if(0!==this.added.length){var e=this.added[this.added.length-1],i=wt.create(n,t);e.addInstruction(i);var o=this.recreatePath();this.addClippedPath(o)}},n.prototype.closePath=function(){0!==this.added.length&&this.added[this.added.length-1].closePath()},n.prototype.moveTo=function(t,n){var e=Ct(t,n.current.transformation);this.areaBuilder.addPosition(e);var i=pn.create(n,t,this.pathInfinityProvider);i.setInitialState(this.state),this.add(i)},n.prototype.canAddLineTo=function(t,n){if(0===this.added.length)return!0;var e=Ct(t,n.current.transformation);return this.added[this.added.length-1].canAddLineTo(e)},n.prototype.lineTo=function(t,n){if(0!==this.added.length){var e=this.added[this.added.length-1],i=Ct(t,n.current.transformation);this.areaBuilder.addPosition(i),e.lineTo(t,n)}else this.moveTo(t,n)},n.prototype.moveToPositionDeterminedBy=function(t,n,e){Number.isFinite(t)?Number.isFinite(n)?this.moveTo(new s(t,n),e):this.moveTo(n<0?ln:fn,e):this.moveTo(t<0?dn:yn,e)},n.prototype.rect=function(t,n,e,i,o){if(!Number.isFinite(t)&&!Number.isFinite(n))return this.moveTo({direction:new s(1,0)},o),this.lineTo({direction:new s(0,1)},o),void this.lineTo({direction:new s(-1,-1)},o);this.moveToPositionDeterminedBy(t,n,o),Pn(t,n,e,i)&&(Number.isFinite(t)?Number.isFinite(n)?(Number.isFinite(e)?(this.lineTo(new s(t+e,n),o),Number.isFinite(i)?(this.lineTo(new s(t+e,n+i),o),this.lineTo(new s(t,n+i),o)):this.lineTo(i>0?fn:ln,o)):(this.lineTo(e>0?yn:dn,o),Number.isFinite(i)?this.lineTo(new s(t,n+i),o):this.lineTo(i>0?fn:ln,o)),this.lineTo(new s(t,n),o)):(Number.isFinite(e)?this.lineTo(new s(t+e,0),o):this.lineTo(e>0?yn:dn,o),this.lineTo(i>0?fn:ln,o),this.lineTo(new s(t,0),o),this.lineTo(n<0?ln:fn,o)):(this.lineTo(new s(0,n),o),this.lineTo(e>0?yn:dn,o),Number.isFinite(i)?this.lineTo(new s(0,n+i),o):this.lineTo(i>0?fn:ln,o),this.lineTo(t<0?dn:yn,o)))},n.prototype.addPathInstruction=function(t,n){if(0===this.added.length){if(!t.initialPoint)return;this.moveTo(t.initialPoint,n)}var e=this.added[this.added.length-1],i=wt.create(n,t.instruction);t.changeArea(this.areaBuilder.transformedWith(n.current.transformation)),e.addPathInstruction(t,i,n)},n.prototype.hasDrawingAcrossBorderOf=function(t){return!t.contains(this.area)&&this.area.intersects(t)},n.prototype.isContainedBy=function(t){return t.contains(this.drawnArea)},n.prototype.intersects=function(t){return!!this.area&&this.area.intersects(t)},n.prototype.getClippedArea=function(t){return t?this.area.intersectWith(t):this.area},n.prototype.recreatePath=function(){for(var t=this.viewboxInfinityProvider.getForPath(),e=new n(this._initiallyWithState.copy(),this.viewboxInfinityProvider,t),i=0,o=this.added;i<o.length;i++){var r=o[i];e.add(r.copy(t))}return e.areaBuilder=this.areaBuilder.copy(),e.setInitialState(e.stateOfFirstInstruction),e},n.create=function(t,e,i){return new n(wt.create(t,(function(t){t.beginPath()})),e,i)},n}(lt),wn=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),In=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o)||this;return s.area=r,s}return wn(n,t),n.prototype.hasDrawingAcrossBorderOf=function(t){return this.intersects(t)&&!this.isContainedBy(t)},n.prototype.intersects=function(t){return this.area.intersects(t)},n.prototype.isContainedBy=function(t){return t.contains(this.area)},n.createDrawing=function(t,e,i){return new n(t,t,e,(function(){}),i)},n}(wt);function Tn(t,n){return!Number.isFinite(t)&&!Number.isFinite(n)&&(t<0&&n>0||t>0&&n<0)}function bn(t,n,e,i){return Tn(t,e)&&Tn(n,i)}var xn=function(){function t(t,n){this.onChange=t,this.infinityProvider=n,this.previousInstructionsWithPath=xt.create(n),this.state=this.previousInstructionsWithPath.state}return t.prototype.beginPath=function(){this.replaceCurrentInstructionsWithPath(mn.create(this.state,this.infinityProvider,this.infinityProvider.getForPath()))},t.prototype.changeState=function(t){this.state=this.state.withCurrentState(t(this.state.current))},t.prototype.saveState=function(){this.state=this.state.saved(),this.setInstructionToRestoreState()},t.prototype.restoreState=function(){this.state=this.state.restored(),this.setInstructionToRestoreState()},t.prototype.allSubpathsAreClosable=function(){return!this.currentInstructionsWithPath||this.currentInstructionsWithPath.allSubpathsAreClosable()},t.prototype.currentPathContainsFinitePoint=function(){return this.currentInstructionsWithPath&&this.currentInstructionsWithPath.containsFinitePoint()},t.prototype.currentSubpathIsClosable=function(){return!this.currentInstructionsWithPath||this.currentInstructionsWithPath.currentSubpathIsClosable()},t.prototype.fillPath=function(t){this.drawPath(t,(function(t,n,e){t.fillPath(n,e)}))},t.prototype.strokePath=function(){this.drawPath((function(t){t.stroke()}),(function(t,n,e){t.strokePath(n,e)}))},t.prototype.fillRect=function(t,n,e,i,o){this.drawRect(t,n,e,i,o,(function(t,n,e){t.fillPath(n,e)}))},t.prototype.strokeRect=function(t,n,e,i){this.drawRect(t,n,e,i,(function(t){t.stroke()}),(function(t,n,e){t.strokePath(n,e)}))},t.prototype.drawPath=function(t,n){if(this.currentInstructionsWithPath){var e=this.state.current.isTransformable();e||(t=Yt(t)),this.state=this.state.currentlyTransformed(e);var i=this.currentInstructionsWithPath.recreatePath();n(this.currentInstructionsWithPath,t,this.state),this.previousInstructionsWithPath.add(this.currentInstructionsWithPath),i.setInitialStateWithClippedPaths(this.previousInstructionsWithPath.state),this.currentInstructionsWithPath=i,this.setInstructionToRestoreState(),this.onChange()}},t.prototype.drawRect=function(t,n,e,i,o,r){this.state.current.isTransformable()||(o=Yt(o));var s=this.state.currentlyTransformed(this.state.current.isTransformable()),a=mn.create(s,this.infinityProvider,this.infinityProvider.getForPath());a.rect(t,n,e,i,s),r(a,o,s),this.drawBeforeCurrentPath(a),this.onChange()},t.prototype.addDrawing=function(t,n,e,i){e===o.Relative?(t=Yt(t),n=n.transform(this.state.current.transformation)):e===o.Absolute&&(t=function(t){return function(n,e){var i=e.a,o=e.b,r=e.c,s=e.d,a=e.e,c=e.f;n.save(),n.setTransform(i,o,r,s,a,c),t(n,e),n.restore()}}(t));var r=n;this.state.current.clippingRegion&&i&&(r=n.intersectWith(this.state.current.clippingRegion));var s=In.createDrawing(this.state.currentlyTransformed(!1),t,r);this.drawBeforeCurrentPath(s),this.onChange()},t.prototype.clipPath=function(t){this.clipCurrentPath(t)},t.prototype.replaceCurrentInstructionsWithPath=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(var i=0,o=n;i<o.length;i++){var r=o[i];r.setInitialStateWithClippedPaths(this.previousInstructionsWithPath.state),this.previousInstructionsWithPath.add(r)}t.setInitialStateWithClippedPaths(this.previousInstructionsWithPath.state),this.currentInstructionsWithPath=t,this.setInstructionToRestoreState()},t.prototype.clipCurrentPath=function(t){this.currentInstructionsWithPath&&(this.currentInstructionsWithPath.clipPath(t,this.state),this.state=this.currentInstructionsWithPath.state)},t.prototype.setInstructionToRestoreState=function(){var t=this.previousInstructionsWithPath.state;this.instructionToRestoreState=t.getInstructionToClearStack()},t.prototype.drawBeforeCurrentPath=function(t){if(this.currentInstructionsWithPath){var n=this.currentInstructionsWithPath.recreatePath();n.setInitialState(this.currentInstructionsWithPath.state),this.replaceCurrentInstructionsWithPath(n,t)}else t.setInitialState(this.previousInstructionsWithPath.state),this.previousInstructionsWithPath.add(t),this.state=this.previousInstructionsWithPath.state},t.prototype.addPathInstruction=function(t){this.currentInstructionsWithPath&&this.currentInstructionsWithPath.addPathInstruction(t,this.state)},t.prototype.closePath=function(){this.currentInstructionsWithPath&&this.currentInstructionsWithPath.closePath()},t.prototype.moveTo=function(t){this.currentInstructionsWithPath&&this.currentInstructionsWithPath.moveTo(t,this.state)},t.prototype.canAddLineTo=function(t){return!this.currentInstructionsWithPath||this.currentInstructionsWithPath.canAddLineTo(t,this.state)},t.prototype.lineTo=function(t){this.currentInstructionsWithPath&&this.currentInstructionsWithPath.lineTo(t,this.state)},t.prototype.rect=function(t,n,e,i){this.currentInstructionsWithPath&&this.currentInstructionsWithPath.rect(t,n,e,i,this.state)},t.prototype.intersects=function(t){return this.previousInstructionsWithPath.intersects(t)||this.currentInstructionsWithPath&&this.currentInstructionsWithPath.intersects(t)},t.prototype.clearContentsInsideArea=function(t){this.previousInstructionsWithPath.clearContentsInsideArea(t),this.currentInstructionsWithPath&&this.currentInstructionsWithPath.setInitialStateWithClippedPaths(this.previousInstructionsWithPath.state)},t.prototype.clearArea=function(t,n,e,i){if(Pn(t,n,e,i)){var o=bn(t,n,e,i)?F:W.createRectangle(t,n,e,i),r=o.transform(this.state.current.transformation);this.intersects(r)&&(this.clearContentsInsideArea(r),this.previousInstructionsWithPath.hasDrawingAcrossBorderOf(r)&&(this.previousInstructionsWithPath.addClearRect(o,this.state,t,n,e,i),this.currentInstructionsWithPath&&this.currentInstructionsWithPath.setInitialStateWithClippedPaths(this.state)),this.onChange())}},t.prototype.execute=function(t,n){this.previousInstructionsWithPath.length&&this.previousInstructionsWithPath.execute(t,n),this.instructionToRestoreState&&this.instructionToRestoreState(t,n)},t}(),Sn=function(){function t(t,n,e){this.getTransformedViewbox=t,this.getViewBoxTransformation=n,this.getLineDashPeriod=e}return t.prototype.clearRect=function(t,n,e,i,o){var r=this.getViewBoxTransformation(),a=this.getTransformedViewbox(),c=r.a,u=r.b,h=r.c,p=r.d,f=r.e,l=r.f;t.save(),t.transform(c,u,h,p,f,l);var d=Number.isFinite(n)?n:a.getPointInFrontInDirection(new s(0,0),n>0?yn.direction:dn.direction).x,y=Number.isFinite(i)?n+i:a.getPointInFrontInDirection(new s(0,0),i>0?yn.direction:dn.direction).x,v=Number.isFinite(e)?e:a.getPointInFrontInDirection(new s(0,0),e>0?fn.direction:ln.direction).y,P=Number.isFinite(o)?e+o:a.getPointInFrontInDirection(new s(0,0),o>0?fn.direction:ln.direction).y;t.clearRect(d,v,y-d,P-v),t.restore()},t.prototype.moveToInfinityFromPointInDirection=function(t,n,e){var i=this.getTransformedViewbox().getPointInFrontInDirection(n,e);this.moveToTransformed(t,i,this.getViewBoxTransformation())},t.prototype.drawLineToInfinityFromInfinityFromPoint=function(t,n,e,i){var o=this.getViewBoxTransformation(),r=this.getTransformedViewbox(),s=r.getPointInFrontInDirection(n,e),a=r.getPointInFrontInDirection(n,i),c=r.expandToIncludePoint(n).expandToIncludePoint(s).expandToIncludePoint(a).vertices.map((function(t){return t.point})).filter((function(t){return!t.equals(s)&&!t.equals(a)&&!t.equals(n)&&t.minus(n).isInSmallerAngleBetweenPoints(e,i)}));c.sort((function(t,i){return t.minus(n).isInSmallerAngleBetweenPoints(i.minus(n),e)?-1:1}));for(var u=s,h=0,p=0,f=c;p<f.length;p++){var l=f[p];h+=l.minus(u).mod(),this.lineToTransformed(t,l,o),u=l}h+=a.minus(u).mod(),this.lineToTransformed(t,a,o),this.ensureDistanceCoveredIsMultipleOfLineDashPeriod(t,o,h,a,i)},t.prototype.drawLineFromInfinityFromPointToInfinityFromPoint=function(t,n,e,i){var o=this.getTransformedViewbox(),r=this.getViewBoxTransformation(),s=o.getPointInFrontInDirection(n,i),a=o.getPointInFrontInDirection(e,i);this.lineToTransformed(t,a,r);var c=a.minus(s).mod();this.ensureDistanceCoveredIsMultipleOfLineDashPeriod(t,r,c,a,i)},t.prototype.drawLineFromInfinityFromPointToPoint=function(t,n,e){var i=this.getViewBoxTransformation(),o=this.getTransformedViewbox().getPointInFrontInDirection(n,e),r=n.minus(o).mod();this.ensureDistanceCoveredIsMultipleOfLineDashPeriod(t,i,r,o,e),this.lineToTransformed(t,n,i)},t.prototype.drawLineToInfinityFromPointInDirection=function(t,n,e){var i=this.getViewBoxTransformation(),o=this.getTransformedViewbox().getPointInFrontInDirection(n,e);this.lineToTransformed(t,o,i);var r=o.minus(n).mod();this.ensureDistanceCoveredIsMultipleOfLineDashPeriod(t,i,r,o,e)},t.prototype.ensureDistanceCoveredIsMultipleOfLineDashPeriod=function(t,n,e,i,o){var r=this.getLineDashPeriod();if(0!==r){var s=this.getDistanceLeft(e,r);if(0!==s){var a=i.plus(o.scale(s/(2*o.mod())));this.lineToTransformed(t,a,n),this.lineToTransformed(t,i,n)}}},t.prototype.lineToTransformed=function(t,n,e){var i=e.apply(n),o=i.x,r=i.y;t.lineTo(o,r)},t.prototype.moveToTransformed=function(t,n,e){var i=e.apply(n),o=i.x,r=i.y;t.moveTo(o,r)},t.prototype.getDistanceLeft=function(t,n){if(0===n)return 0;var e=t/n|0;return t-n*e==0?0:(e+1)*n-t},t}(),Cn=function(){function t(t){this.viewboxInfinityProvider=t,this.drawnLineWidth=0,this.lineDashPeriod=0}return t.prototype.getPathInstructionToGoAroundViewbox=function(){var t=this.drawnLineWidth,n=this.viewboxInfinityProvider.viewBoxWidth+2*t,e=this.viewboxInfinityProvider.viewBoxHeight+2*t;return function(i){i.save(),i.setTransform(1,0,0,1,0,0),i.rect(-t,-t,n,e),i.restore()}},t.prototype.addDrawnLineWidth=function(t){this.drawnLineWidth=t},t.prototype.addLineDashPeriod=function(t){this.lineDashPeriod=t},t.prototype.getInfinity=function(t){var n=this,e=t.current.transformation;return new Sn((function(){var t=e.before(n.viewboxInfinityProvider.viewBoxTransformation);return n.viewboxInfinityProvider.viewBoxRectangle.expandByDistance(n.drawnLineWidth*n.viewboxInfinityProvider.viewBoxTransformation.scale).transform(t.inverse())}),(function(){return n.viewboxInfinityProvider.viewBoxTransformation}),(function(){return n.lineDashPeriod}))},t}(),Bn=function(){function t(t,n){this.viewBoxWidth=t,this.viewBoxHeight=n,this.viewBoxTransformation=a.identity,this.viewBoxRectangle=W.createRectangle(0,0,t,n)}return t.prototype.getForPath=function(){return new Cn(this)},t}(),On=function(t,n,e,i){return new(e||(e=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,a)}c((i=i.apply(t,n||[])).next())}))},_n=function(t,n){var e,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=n.call(t,s)}catch(t){r=[6,t],i=0}finally{e=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},An=function(){function t(t,n,e,i,o){var r=this;this.width=t,this.height=n,this.context=e,this.drawingIterationProvider=i,this.drawLockProvider=o,this.infinityProvider=new Bn(t,n),this.instructionSet=new xn((function(){return i.provideDrawingIteration((function(){return r.draw()}))}),this.infinityProvider),this._transformation=a.identity}return Object.defineProperty(t.prototype,"state",{get:function(){return this.instructionSet.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transformation",{get:function(){return this._transformation},set:function(t){var n=this;this._transformation=t,this.infinityProvider.viewBoxTransformation=t,this.drawingIterationProvider.provideDrawingIteration((function(){return n.draw()}))},enumerable:!0,configurable:!0}),t.prototype.getDrawingLock=function(){return this.drawLockProvider()},t.prototype.changeState=function(t){this.instructionSet.changeState(t)},t.prototype.measureText=function(t){this.context.save(),st.default.getInstructionToConvertToState(this.state.currentlyTransformed(!1).current)(this.context,a.identity);var n=this.context.measureText(t);return this.context.restore(),n},t.prototype.saveState=function(){this.instructionSet.saveState()},t.prototype.restoreState=function(){this.instructionSet.restoreState()},t.prototype.beginPath=function(){this.instructionSet.beginPath()},t.prototype.createPatternFromImageData=function(t){return On(this,void 0,void 0,(function(){var n;return _n(this,(function(e){switch(e.label){case 0:return[4,createImageBitmap(t)];case 1:return n=e.sent(),[2,this.context.createPattern(n,"no-repeat")]}}))}))},t.prototype.addDrawing=function(t,n,e,i){this.instructionSet.addDrawing(t,n,e,i)},t.prototype.addPathInstruction=function(t){this.instructionSet.addPathInstruction(t)},t.prototype.closePath=function(){this.instructionSet.currentSubpathIsClosable()&&this.instructionSet.closePath()},t.prototype.moveTo=function(t){this.instructionSet.moveTo(t)},t.prototype.lineTo=function(t){this.instructionSet.canAddLineTo(t)&&this.instructionSet.lineTo(t)},t.prototype.rect=function(t,n,e,i){this.instructionSet.rect(t,n,e,i)},t.prototype.currentPathCanBeFilled=function(){return this.instructionSet.allSubpathsAreClosable()&&this.instructionSet.currentPathContainsFinitePoint()},t.prototype.fillPath=function(t){this.instructionSet.fillPath(t)},t.prototype.strokePath=function(){this.instructionSet.strokePath()},t.prototype.fillRect=function(t,n,e,i,o){Pn(t,n,e,i)&&this.instructionSet.fillRect(t,n,e,i,o)},t.prototype.strokeRect=function(t,n,e,i){Pn(t,n,e,i)&&!bn(t,n,e,i)&&this.instructionSet.strokeRect(t,n,e,i)},t.prototype.clipPath=function(t){this.instructionSet.clipPath(t)},t.prototype.clearArea=function(t,n,e,i){this.instructionSet.clearArea(t,n,e,i)},t.prototype.createLinearGradient=function(t,n,e,i){return new ht(this.context,t,n,e,i)},t.prototype.createRadialGradient=function(t,n,e,i,o,r){return new ft(this.context,t,n,e,i,o,r)},t.prototype.createPattern=function(t,n){return new y(this.context.createPattern(t,n))},t.prototype.draw=function(){this.context.restore(),this.context.save(),this.context.clearRect(0,0,this.width,this.height),this.instructionSet.execute(this.context,this._transformation)},t}(),Dn=function(t,n){this.initial=t,this.cancel=n,this.current=t},Ln=function(){function t(t){this.point=t,this.handlers=[]}return t.prototype.removeHandler=function(t){var n=this.handlers.indexOf(t);return n>-1&&this.handlers.splice(n,1),this},t.prototype.moveTo=function(t,n){var e=new s(t,n);this.point=e;for(var i=0,o=this.handlers;i<o.length;i++){(0,o[i])(e)}},t.prototype.onMoved=function(t){var n,e=this,i=function(e){n.current=e,t()};return this.handlers.push(i),n=new Dn(this.point,(function(){return e.removeHandler(i)}))},t}(),Fn=function(){function t(t,n){var e=this;this.context=n,this.initialTransformation=n.transformation,this.point=t.onMoved((function(){e.setTransformation()}))}return t.prototype.setTransformation=function(){this.context.transformation=this.initialTransformation.before(this.getTranslation())},t.prototype.getTranslation=function(){return a.translation(this.point.current.x-this.point.initial.x,this.point.current.y-this.point.initial.y)},t.prototype.withMovable=function(t){return this.context.getGestureForTwoMovables(this.point.cancel(),t)},t.prototype.withoutMovable=function(t){},t}(),Wn=function(){function t(t,n,e){var i=this;this.context=e,this.initialTransformation=e.transformation,this.point1=t.onMoved((function(){return i.setTransformation()})),this.point2=n.onMoved((function(){return i.setTransformation()}))}return t.prototype.withMovable=function(t){},t.prototype.withoutMovable=function(t){var n=this.point1.cancel(),e=this.point2.cancel();return t===n?this.context.getGestureForOneMovable(e):t===e?this.context.getGestureForOneMovable(n):void 0},t}(),jn=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Rn=function(t){function n(n,e,i){return t.call(this,n,e,i)||this}return jn(n,t),n.prototype.setTransformation=function(){this.context.transformation=this.initialTransformation.before(a.translateZoom(this.point1.initial.x,this.point1.initial.y,this.point2.initial.x,this.point2.initial.y,this.point1.current.x,this.point1.current.y,this.point2.current.x,this.point2.current.y))},n}(Wn),kn=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Nn=function(t){function n(n,e,i){return t.call(this,n,e,i)||this}return kn(n,t),n.prototype.setTransformation=function(){this.context.transformation=this.initialTransformation.before(a.translateRotateZoom(this.point1.initial.x,this.point1.initial.y,this.point2.initial.x,this.point2.initial.y,this.point1.current.x,this.point1.current.y,this.point2.current.x,this.point2.current.y))},n}(Wn),Vn=function(){function t(t,n){this.transformable=t,this.config=n}return Object.defineProperty(t.prototype,"transformation",{get:function(){return this.transformable.transformation},set:function(t){this.transformable.transformation=t},enumerable:!0,configurable:!0}),t.prototype.getGestureForOneMovable=function(t){return new Fn(t,this)},t.prototype.getGestureForTwoMovables=function(t,n){return this.config.rotationEnabled?new Nn(t,n,this):new Rn(t,n,this)},t}(),Mn=function(){function t(t,n){var e=this;this.viewBox=n,this.initialTransformation=n.transformation,this.angularVelocity=4*Math.PI/n.width,this.point=t.onMoved((function(){e.setTransformation()}))}return t.prototype.setTransformation=function(){this.viewBox.transformation=this.initialTransformation.before(a.rotation(this.point.initial.x,this.point.initial.y,(this.point.initial.x-this.point.current.x)*this.angularVelocity))},t.prototype.end=function(){this.point.cancel()},t}(),En=function(){function t(t,n,e,i,o){this.transformable=t,this.centerX=n,this.centerY=e,this.onFinish=o,this.maxScaleLogStep=.1,this.initialTransformation=t.transformation,this.currentScaleLog=0,this.targetScaleLog=Math.log(i),this.makeStep()}return t.prototype.makeStep=function(){var t=this,n=this.targetScaleLog-this.currentScaleLog;Math.abs(n)<=this.maxScaleLogStep?(this.currentScaleLog+=n,this.setTransformToCurrentScaleLog(),this.onFinish()):(this.currentScaleLog+=n<0?-this.maxScaleLogStep:this.maxScaleLogStep,this.setTransformToCurrentScaleLog(),this.stepTimeout=setTimeout((function(){return t.makeStep()}),20))},t.prototype.setTransformToCurrentScaleLog=function(){this.transformable.transformation=this.initialTransformation.before(a.zoom(this.centerX,this.centerY,Math.exp(this.currentScaleLog)))},t.prototype.cancel=function(){void 0!==this.stepTimeout&&clearTimeout(this.stepTimeout)},t}(),qn=function(){function t(t,n){this.viewBox=t,this.context=new Vn(t,n)}return t.prototype.createAnchor=function(t){var n=this;return{moveTo:function(n,e){t.moveTo(n,e)},release:function(){n.gesture=n.gesture.withoutMovable(t)}}},t.prototype.zoom=function(t,n,e){var i=this;this._zoom&&this._zoom.cancel(),this._zoom=new En(this.viewBox,t,n,e,(function(){return i._zoom=void 0}))},t.prototype.getAnchor=function(t,n){var e=new Ln(new s(t,n));if(!this.gesture)return this.gesture=this.context.getGestureForOneMovable(e),this.createAnchor(e);var i=this.gesture.withMovable(e);return i?(this.gesture=i,this.createAnchor(e)):void 0},t.prototype.getRotationAnchor=function(t,n){var e=new Ln(new s(t,n)),i=new Mn(e,this.viewBox);return{moveTo:function(t,n){e.moveTo(t,n)},release:function(){i.end()}}},t}();var Hn=function(){function t(){this.latestIdentifier=0,this.records=[]}return t.prototype.addAnchor=function(t,n){var e=++this.latestIdentifier;return this.records.push({identifier:e,anchor:t,externalIdentifier:n}),e},t.prototype.getAnchorByIdentifier=function(t){var n=this.records.find((function(n){return n.identifier===t}));if(n)return n.anchor},t.prototype.getAnchorByExternalIdentifier=function(t){var n=this.records.find((function(n){return n.externalIdentifier===t}));if(n)return n.anchor},t.prototype.removeAnchorByIdentifier=function(t){var n=this.records.findIndex((function(n){return n.identifier===t}));n>-1&&this.records.splice(n,1)},t.prototype.removeAnchorByExternalIdentifier=function(t){var n=this.records.findIndex((function(n){return n.externalIdentifier===t}));n>-1&&this.records.splice(n,1)},t}();var Gn=function(t,n,e,i){function o(n,e){var i=t.getBoundingClientRect();return new s(n-i.left,e-i.top)}this.anchorSet=new Hn,function(t,n,e,i,o){t.addEventListener("wheel",(function(t){if(!o.greedyGestureHandling&&!t.ctrlKey)return!0;var e=i(t.clientX,t.clientY),r=e.x,s=e.y,a=t.deltaY,c=Math.pow(2,-a/300);return n.zoom(r,s,c),t.preventDefault(),!1}))}(t,e,this.anchorSet,o,i),function(t,n,e,i,o){var r;function s(){void 0!==r&&(e.getAnchorByIdentifier(r).release(),e.removeAnchorByIdentifier(r),r=void 0)}t.addEventListener("mousedown",(function(t){if(void 0===r){var s,a=i(t.clientX,t.clientY),c=a.x,u=a.y;if(1===t.button){if(!o.rotationEnabled)return!0;s=n.getRotationAnchor(c,u)}else s=n.getAnchor(c,u);return r=e.addAnchor(s),t.preventDefault(),!1}})),t.addEventListener("mousemove",(function(t){if(void 0!==r){var n=i(t.clientX,t.clientY),o=n.x,s=n.y;e.getAnchorByIdentifier(r).moveTo(o,s)}})),t.addEventListener("mouseup",(function(t){s()})),t.addEventListener("mouseleave",(function(t){s()}))}(t,e,this.anchorSet,o,i),function(t,n,e,i,o){t.addEventListener("touchstart",(function(t){var r=t.touches;if(1===r.length&&!o.greedyGestureHandling)return!0;if(!t.cancelable)return console.log("touchstart event was not cancelable"),!0;for(var s=0;s<r.length;s++){var a=r[s],c=a.identifier;if(!e.getAnchorByExternalIdentifier(c)){var u=i(a.clientX,a.clientY),h=u.x,p=u.y,f=n.getAnchor(h,p);e.addAnchor(f,c)}}return t.preventDefault(),!1})),t.addEventListener("touchmove",(function(t){for(var n=t.changedTouches,o=0;o<n.length;o++){var r=n[o],s=e.getAnchorByExternalIdentifier(r.identifier);if(s){var a=i(r.clientX,r.clientY),c=a.x,u=a.y;s.moveTo(c,u)}}})),t.addEventListener("touchend",(function(t){for(var n=t.changedTouches,i=0;i<n.length;i++){var o=n[i],r=e.getAnchorByExternalIdentifier(o.identifier);r&&(r.release(),e.removeAnchorByExternalIdentifier(o.identifier))}}))}(t,e,this.anchorSet,o,i)},zn=function(){function t(){this.animationFrameRequested=!1}return t.prototype.provideDrawingIteration=function(t){var n=this;this.animationFrameRequested||(this.animationFrameRequested=!0,requestAnimationFrame((function(){t(),n.animationFrameRequested=!1})))},t}(),Un=function(){function t(t){this.infiniteCanvas=t,this.listeners=[],this.onceListeners=[]}return t.prototype.dispatchEvent=function(t){var n=this.onceListeners;this.onceListeners=[];for(var e=0,i=n;e<i.length;e++){var o=i[e];this.notifyListener(o,t)}for(var r=0,s=this.listeners;r<s.length;r++){var a=s[r];this.notifyListener(a,t)}},t.prototype.addListener=function(t,n){n&&n.once?this.onceListeners.push(t):this.listeners.push(t)},t.prototype.notifyListener=function(t,n){try{t.call(this.infiniteCanvas,n)}catch(t){console.error(t)}},t}(),Yn=function(){function t(t){this.drawingIterationProvider=t,this._drawCallback=function(){}}return t.prototype.provideDrawingIteration=function(t){var n=this;this.drawingIterationProvider.provideDrawingIteration((function(){t(),n._drawCallback&&n._drawCallback()}))},t.prototype.onDraw=function(t){this._drawCallback=t},t}(),Xn=function(){function t(t){this.drawingIterationProvider=t,this._locks=[]}return t.prototype.removeLock=function(t){var n=this._locks.indexOf(t);this._locks.splice(n,1),0===this._locks.length&&this._draw&&this.drawingIterationProvider.provideDrawingIteration(this._draw)},t.prototype.provideDrawingIteration=function(t){this._locks.length?this._draw=t:this.drawingIterationProvider.provideDrawingIteration(t)},t.prototype.getLock=function(){var t,n=this;return t={release:function(){n.removeLock(t)}},this._locks.push(t),t},t}();e.d(n,"InfiniteCanvas",(function(){return Zn}));var Zn=function(){function t(t,n){var e=this;this.canvas=t,this.config=n||{rotationEnabled:!0,greedyGestureHandling:!1},this.eventDispatchers={draw:new Un(this)};var i=new Yn(new zn);i.onDraw((function(){return e.dispatchDrawEvent()}));var o=new Xn(i);this.viewBox=new An(t.width,t.height,t.getContext("2d"),o,(function(){return o.getLock()})),this.transformer=new qn(this.viewBox,this.config);new Gn(t,this.viewBox,this.transformer,this.config)}return t.prototype.getContext=function(){return this.context||(this.context=new it(this.canvas,this.viewBox)),this.context},Object.defineProperty(t.prototype,"rotationEnabled",{get:function(){return this.config.rotationEnabled},set:function(t){this.config.rotationEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"greedyGestureHandling",{get:function(){return this.config.greedyGestureHandling},set:function(t){this.config.greedyGestureHandling=t},enumerable:!0,configurable:!0}),t.prototype.addEventListener=function(t,n,e){this.eventDispatchers[t].addListener(n,e)},t.prototype.dispatchDrawEvent=function(){this.eventDispatchers.draw.dispatchEvent({})},t}()}]);